"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.js":
/*!***********************!*\
  !*** ./middleware.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! nanoid */ \"(middleware)/./node_modules/nanoid/index.browser.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(middleware)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\n\n// Rate limiting implementation\nconst requestCounts = new Map();\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\nconst RATE_LIMITS = {\n    \"/api/responses\": {\n        max: 10,\n        window: RATE_LIMIT_WINDOW\n    },\n    \"/api/forms/upload\": {\n        max: 5,\n        window: RATE_LIMIT_WINDOW\n    },\n    \"/api/ai-analysis\": {\n        max: 5,\n        window: RATE_LIMIT_WINDOW\n    },\n    default: {\n        max: 100,\n        window: RATE_LIMIT_WINDOW\n    } // 100 requests per minute for other endpoints\n};\nfunction getRateLimit(pathname) {\n    for (const [path, limit] of Object.entries(RATE_LIMITS)){\n        if (pathname.startsWith(path)) {\n            return limit;\n        }\n    }\n    return RATE_LIMITS.default;\n}\nfunction checkRateLimit(ip, pathname) {\n    const key = `${ip}:${pathname}`;\n    const limit = getRateLimit(pathname);\n    const now = Date.now();\n    if (!requestCounts.has(key)) {\n        requestCounts.set(key, {\n            count: 1,\n            resetTime: now + limit.window\n        });\n        return true;\n    }\n    const record = requestCounts.get(key);\n    if (now > record.resetTime) {\n        record.count = 1;\n        record.resetTime = now + limit.window;\n        return true;\n    }\n    if (record.count >= limit.max) {\n        return false;\n    }\n    record.count++;\n    return true;\n}\n// Note: In production, use a proper cache like Redis for rate limiting\n// The Map will be cleared on server restart\nasync function middleware(request) {\n    let response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n        request: {\n            headers: request.headers\n        }\n    });\n    const { pathname } = request.nextUrl;\n    // Authentication check for protected routes\n    const supabaseUrl = \"https://eycgzjqwowrdmjlzqqyg.supabase.co\";\n    const supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5Y2d6anF3b3dyZG1qbHpxcXlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwODcyMDIsImV4cCI6MjA2OTY2MzIwMn0.QfdUDAF8MweVTmJtrgnPiLWRdXz7hpFIzre-hiVay4E\" || 0;\n    if (supabaseUrl && supabaseKey) {\n        const supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseKey, {\n            cookies: {\n                get (name) {\n                    return request.cookies.get(name)?.value;\n                },\n                set (name, value, options) {\n                    // Ensure proper cookie settings for production\n                    const cookieOptions = {\n                        name,\n                        value,\n                        ...options,\n                        sameSite: \"lax\",\n                        secure: \"development\" === \"production\",\n                        httpOnly: true,\n                        path: \"/\"\n                    };\n                    request.cookies.set(cookieOptions);\n                    response.cookies.set(cookieOptions);\n                },\n                remove (name, options) {\n                    const removeOptions = {\n                        name,\n                        value: \"\",\n                        ...options,\n                        maxAge: 0,\n                        path: \"/\"\n                    };\n                    request.cookies.set(removeOptions);\n                    response.cookies.set(removeOptions);\n                }\n            }\n        });\n        // Refresh session if expired\n        const { data: { user } } = await supabase.auth.getUser();\n        // Get user profile if authenticated\n        let userRole = null;\n        if (user) {\n            const { data: profile } = await supabase.from(\"aloa_user_profiles\").select(\"role\").eq(\"id\", user.id).single();\n            userRole = profile?.role;\n        }\n        // Protected routes that require authentication\n        const protectedPaths = [\n            \"/dashboard\",\n            \"/create\",\n            \"/edit\",\n            \"/responses\",\n            \"/ai-analysis\",\n            \"/admin\",\n            \"/profile\",\n            \"/settings\"\n        ];\n        const isProtectedPath = protectedPaths.some((path)=>pathname.startsWith(path));\n        // Redirect admins from /dashboard to /admin/projects\n        if (pathname === \"/dashboard\" && user && (userRole === \"super_admin\" || userRole === \"project_admin\" || userRole === \"team_member\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/projects\", request.url));\n        }\n        // Auth routes that should redirect if already logged in\n        const authPaths = [\n            \"/auth/login\",\n            \"/auth/signup\"\n        ];\n        const isAuthPath = authPaths.some((path)=>pathname.startsWith(path));\n        // If accessing protected route without authentication, redirect to login\n        if (isProtectedPath && !user) {\n            const redirectUrl = new URL(\"/auth/login\", request.url);\n            redirectUrl.searchParams.set(\"redirect\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(redirectUrl);\n        }\n        // If accessing auth routes while authenticated, redirect based on role\n        if (isAuthPath && user) {\n            if (userRole === \"super_admin\" || userRole === \"project_admin\" || userRole === \"team_member\") {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/projects\", request.url));\n            } else {\n                // For clients, we'd need to get their project, so just go to dashboard for now\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/dashboard\", request.url));\n            }\n        }\n        // For the root path, redirect based on auth status and role\n        if (pathname === \"/\") {\n            if (user) {\n                if (userRole === \"super_admin\" || userRole === \"project_admin\" || userRole === \"team_member\") {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/projects\", request.url));\n                } else {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/dashboard\", request.url));\n                }\n            } else {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/auth/login\", request.url));\n            }\n        }\n    }\n    // Get client IP (works with Vercel)\n    const ip = request.headers.get(\"x-forwarded-for\")?.split(\",\")[0] || request.headers.get(\"x-real-ip\") || request.ip || \"unknown\";\n    // Apply rate limiting to API routes\n    if (pathname.startsWith(\"/api/\")) {\n        if (!checkRateLimit(ip, pathname)) {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify({\n                error: \"Too many requests. Please try again later.\",\n                retryAfter: 60\n            }), {\n                status: 429,\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Retry-After\": \"60\",\n                    \"X-RateLimit-Limit\": String(getRateLimit(pathname).max),\n                    \"X-RateLimit-Remaining\": \"0\",\n                    \"X-RateLimit-Reset\": String(Date.now() + RATE_LIMIT_WINDOW)\n                }\n            });\n        }\n    }\n    // Generate and attach CSRF token for state-changing operations\n    const csrfToken = request.cookies.get(\"csrf-token\")?.value || (0,nanoid__WEBPACK_IMPORTED_MODULE_2__.nanoid)();\n    // Set security headers\n    response.headers.set(\"X-Content-Type-Options\", \"nosniff\");\n    response.headers.set(\"X-Frame-Options\", \"DENY\");\n    response.headers.set(\"X-XSS-Protection\", \"1; mode=block\");\n    response.headers.set(\"Referrer-Policy\", \"strict-origin-when-cross-origin\");\n    response.headers.set(\"Permissions-Policy\", \"camera=(), microphone=(), geolocation=()\");\n    // Content Security Policy\n    const cspDirectives = [\n        \"default-src 'self'\",\n        \"script-src 'self' 'unsafe-inline' 'unsafe-eval' https://vercel.live\",\n        \"style-src 'self' 'unsafe-inline'\",\n        \"img-src 'self' data: https: blob:\",\n        \"font-src 'self' data:\",\n        \"connect-src 'self' https://*.supabase.co https://vercel.live wss://ws-us3.pusher.com\",\n        \"frame-src 'self' https://vercel.live\",\n        \"form-action 'self'\",\n        \"base-uri 'self'\",\n        \"object-src 'none'\",\n        \"frame-ancestors 'none'\"\n    ];\n    response.headers.set(\"Content-Security-Policy\", cspDirectives.join(\"; \"));\n    // Always set CSRF token cookie if it doesn't exist\n    if (!request.cookies.get(\"csrf-token\")) {\n        response.cookies.set({\n            name: \"csrf-token\",\n            value: csrfToken,\n            httpOnly: false,\n            secure: \"development\" === \"production\",\n            sameSite: \"strict\",\n            path: \"/\",\n            maxAge: 60 * 60 * 24 // 24 hours\n        });\n    }\n    // CORS configuration for API routes\n    if (pathname.startsWith(\"/api/\")) {\n        const origin = request.headers.get(\"origin\");\n        const allowedOrigins = [\n            \"https://custom-forms-xi.vercel.app\",\n            \"http://localhost:3000\",\n            \"http://localhost:3001\"\n        ];\n        if (origin && allowedOrigins.includes(origin)) {\n            response.headers.set(\"Access-Control-Allow-Origin\", origin);\n            response.headers.set(\"Access-Control-Allow-Credentials\", \"true\");\n            response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n            response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization, X-CSRF-Token\");\n            response.headers.set(\"Access-Control-Max-Age\", \"86400\");\n        }\n        // Handle preflight requests\n        if (request.method === \"OPTIONS\") {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n                status: 200,\n                headers: response.headers\n            });\n        }\n    }\n    return response;\n}\nconst config = {\n    matcher: [\n        \"/((?!_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDVm5DLE1BQU07WUFDTndDLFFBQVEsS0FBSyxLQUFLLEdBQUcsV0FBVztRQUNsQztJQUNGO0lBRUEsb0NBQW9DO0lBQ3BDLElBQUl6QyxTQUFTSyxVQUFVLENBQUMsVUFBVTtRQUNoQyxNQUFNcUUsU0FBU3hELFFBQVFHLE9BQU8sQ0FBQ0wsR0FBRyxDQUFDO1FBQ25DLE1BQU0yRCxpQkFBaUI7WUFDckI7WUFDQTtZQUNBO1NBQ0Q7UUFFRCxJQUFJRCxVQUFVQyxlQUFlQyxRQUFRLENBQUNGLFNBQVM7WUFDN0N2RCxTQUFTRSxPQUFPLENBQUNULEdBQUcsQ0FBQywrQkFBK0I4RDtZQUNwRHZELFNBQVNFLE9BQU8sQ0FBQ1QsR0FBRyxDQUFDLG9DQUFvQztZQUN6RE8sU0FBU0UsT0FBTyxDQUFDVCxHQUFHLENBQUMsZ0NBQWdDO1lBQ3JETyxTQUFTRSxPQUFPLENBQUNULEdBQUcsQ0FBQyxnQ0FBZ0M7WUFDckRPLFNBQVNFLE9BQU8sQ0FBQ1QsR0FBRyxDQUFDLDBCQUEwQjtRQUNqRDtRQUVBLDRCQUE0QjtRQUM1QixJQUFJTSxRQUFRMkQsTUFBTSxLQUFLLFdBQVc7WUFDaEMsT0FBTyxJQUFJeEYscURBQVlBLENBQUMsTUFBTTtnQkFBRWdGLFFBQVE7Z0JBQUtoRCxTQUFTRixTQUFTRSxPQUFPO1lBQUM7UUFDekU7SUFDRjtJQUVBLE9BQU9GO0FBQ1Q7QUFFTyxNQUFNMkQsU0FBUztJQUNwQkMsU0FBUztRQUNQO0tBQ0Q7QUFDSCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL21pZGRsZXdhcmUuanM/M2JjYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tICduYW5vaWQnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3Nzcic7XG5cbi8vIFJhdGUgbGltaXRpbmcgaW1wbGVtZW50YXRpb25cbmNvbnN0IHJlcXVlc3RDb3VudHMgPSBuZXcgTWFwKCk7XG5jb25zdCBSQVRFX0xJTUlUX1dJTkRPVyA9IDYwICogMTAwMDsgLy8gMSBtaW51dGVcbmNvbnN0IFJBVEVfTElNSVRTID0ge1xuICAnL2FwaS9yZXNwb25zZXMnOiB7IG1heDogMTAsIHdpbmRvdzogUkFURV9MSU1JVF9XSU5ET1cgfSwgLy8gMTAgZm9ybSBzdWJtaXNzaW9ucyBwZXIgbWludXRlXG4gICcvYXBpL2Zvcm1zL3VwbG9hZCc6IHsgbWF4OiA1LCB3aW5kb3c6IFJBVEVfTElNSVRfV0lORE9XIH0sIC8vIDUgZmlsZSB1cGxvYWRzIHBlciBtaW51dGVcbiAgJy9hcGkvYWktYW5hbHlzaXMnOiB7IG1heDogNSwgd2luZG93OiBSQVRFX0xJTUlUX1dJTkRPVyB9LCAvLyA1IEFJIGFuYWx5c2lzIHJlcXVlc3RzIHBlciBtaW51dGVcbiAgZGVmYXVsdDogeyBtYXg6IDEwMCwgd2luZG93OiBSQVRFX0xJTUlUX1dJTkRPVyB9IC8vIDEwMCByZXF1ZXN0cyBwZXIgbWludXRlIGZvciBvdGhlciBlbmRwb2ludHNcbn07XG5cbmZ1bmN0aW9uIGdldFJhdGVMaW1pdChwYXRobmFtZSkge1xuICBmb3IgKGNvbnN0IFtwYXRoLCBsaW1pdF0gb2YgT2JqZWN0LmVudHJpZXMoUkFURV9MSU1JVFMpKSB7XG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgocGF0aCkpIHtcbiAgICAgIHJldHVybiBsaW1pdDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFJBVEVfTElNSVRTLmRlZmF1bHQ7XG59XG5cbmZ1bmN0aW9uIGNoZWNrUmF0ZUxpbWl0KGlwLCBwYXRobmFtZSkge1xuICBjb25zdCBrZXkgPSBgJHtpcH06JHtwYXRobmFtZX1gO1xuICBjb25zdCBsaW1pdCA9IGdldFJhdGVMaW1pdChwYXRobmFtZSk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIFxuICBpZiAoIXJlcXVlc3RDb3VudHMuaGFzKGtleSkpIHtcbiAgICByZXF1ZXN0Q291bnRzLnNldChrZXksIHsgY291bnQ6IDEsIHJlc2V0VGltZTogbm93ICsgbGltaXQud2luZG93IH0pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIFxuICBjb25zdCByZWNvcmQgPSByZXF1ZXN0Q291bnRzLmdldChrZXkpO1xuICBcbiAgaWYgKG5vdyA+IHJlY29yZC5yZXNldFRpbWUpIHtcbiAgICByZWNvcmQuY291bnQgPSAxO1xuICAgIHJlY29yZC5yZXNldFRpbWUgPSBub3cgKyBsaW1pdC53aW5kb3c7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgXG4gIGlmIChyZWNvcmQuY291bnQgPj0gbGltaXQubWF4KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIFxuICByZWNvcmQuY291bnQrKztcbiAgcmV0dXJuIHRydWU7XG59XG5cbi8vIE5vdGU6IEluIHByb2R1Y3Rpb24sIHVzZSBhIHByb3BlciBjYWNoZSBsaWtlIFJlZGlzIGZvciByYXRlIGxpbWl0aW5nXG4vLyBUaGUgTWFwIHdpbGwgYmUgY2xlYXJlZCBvbiBzZXJ2ZXIgcmVzdGFydFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0KSB7XG4gIGxldCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5uZXh0KHtcbiAgICByZXF1ZXN0OiB7XG4gICAgICBoZWFkZXJzOiByZXF1ZXN0LmhlYWRlcnMsXG4gICAgfSxcbiAgfSk7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcXVlc3QubmV4dFVybDtcbiAgXG4gIC8vIEF1dGhlbnRpY2F0aW9uIGNoZWNrIGZvciBwcm90ZWN0ZWQgcm91dGVzXG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICBjb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1BVQkxJU0hBQkxFX0tFWTtcbiAgXG4gIGlmIChzdXBhYmFzZVVybCAmJiBzdXBhYmFzZUtleSkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgICAgc3VwYWJhc2VVcmwsXG4gICAgICBzdXBhYmFzZUtleSxcbiAgICAgIHtcbiAgICAgICAgY29va2llczoge1xuICAgICAgICAgIGdldChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5jb29raWVzLmdldChuYW1lKT8udmFsdWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXQobmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIC8vIEVuc3VyZSBwcm9wZXIgY29va2llIHNldHRpbmdzIGZvciBwcm9kdWN0aW9uXG4gICAgICAgICAgICBjb25zdCBjb29raWVPcHRpb25zID0ge1xuICAgICAgICAgICAgICBuYW1lLFxuICAgICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgICAgc2FtZVNpdGU6ICdsYXgnLFxuICAgICAgICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICAgICAgICAgIGh0dHBPbmx5OiB0cnVlLFxuICAgICAgICAgICAgICBwYXRoOiAnLydcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0LmNvb2tpZXMuc2V0KGNvb2tpZU9wdGlvbnMpO1xuICAgICAgICAgICAgcmVzcG9uc2UuY29va2llcy5zZXQoY29va2llT3B0aW9ucyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZW1vdmUobmFtZSwgb3B0aW9ucykge1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgICAgICBtYXhBZ2U6IDAsXG4gICAgICAgICAgICAgIHBhdGg6ICcvJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcXVlc3QuY29va2llcy5zZXQocmVtb3ZlT3B0aW9ucyk7XG4gICAgICAgICAgICByZXNwb25zZS5jb29raWVzLnNldChyZW1vdmVPcHRpb25zKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfVxuICAgICk7XG5cbiAgICAvLyBSZWZyZXNoIHNlc3Npb24gaWYgZXhwaXJlZFxuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuICAgIFxuICAgIC8vIEdldCB1c2VyIHByb2ZpbGUgaWYgYXV0aGVudGljYXRlZFxuICAgIGxldCB1c2VyUm9sZSA9IG51bGw7XG4gICAgaWYgKHVzZXIpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2Fsb2FfdXNlcl9wcm9maWxlcycpXG4gICAgICAgIC5zZWxlY3QoJ3JvbGUnKVxuICAgICAgICAuZXEoJ2lkJywgdXNlci5pZClcbiAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgXG4gICAgICB1c2VyUm9sZSA9IHByb2ZpbGU/LnJvbGU7XG4gICAgfVxuXG4gICAgLy8gUHJvdGVjdGVkIHJvdXRlcyB0aGF0IHJlcXVpcmUgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCBwcm90ZWN0ZWRQYXRocyA9IFtcbiAgICAgICcvZGFzaGJvYXJkJyxcbiAgICAgICcvY3JlYXRlJyxcbiAgICAgICcvZWRpdCcsXG4gICAgICAnL3Jlc3BvbnNlcycsXG4gICAgICAnL2FpLWFuYWx5c2lzJyxcbiAgICAgICcvYWRtaW4nLFxuICAgICAgJy9wcm9maWxlJyxcbiAgICAgICcvc2V0dGluZ3MnXG4gICAgXTtcblxuICAgIGNvbnN0IGlzUHJvdGVjdGVkUGF0aCA9IHByb3RlY3RlZFBhdGhzLnNvbWUocGF0aCA9PiBcbiAgICAgIHBhdGhuYW1lLnN0YXJ0c1dpdGgocGF0aClcbiAgICApO1xuICAgIFxuICAgIC8vIFJlZGlyZWN0IGFkbWlucyBmcm9tIC9kYXNoYm9hcmQgdG8gL2FkbWluL3Byb2plY3RzXG4gICAgaWYgKHBhdGhuYW1lID09PSAnL2Rhc2hib2FyZCcgJiYgdXNlciAmJiAodXNlclJvbGUgPT09ICdzdXBlcl9hZG1pbicgfHwgdXNlclJvbGUgPT09ICdwcm9qZWN0X2FkbWluJyB8fCB1c2VyUm9sZSA9PT0gJ3RlYW1fbWVtYmVyJykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2FkbWluL3Byb2plY3RzJywgcmVxdWVzdC51cmwpKTtcbiAgICB9XG5cbiAgICAvLyBBdXRoIHJvdXRlcyB0aGF0IHNob3VsZCByZWRpcmVjdCBpZiBhbHJlYWR5IGxvZ2dlZCBpblxuICAgIGNvbnN0IGF1dGhQYXRocyA9IFsnL2F1dGgvbG9naW4nLCAnL2F1dGgvc2lnbnVwJ107XG4gICAgY29uc3QgaXNBdXRoUGF0aCA9IGF1dGhQYXRocy5zb21lKHBhdGggPT4gXG4gICAgICBwYXRobmFtZS5zdGFydHNXaXRoKHBhdGgpXG4gICAgKTtcblxuICAgIC8vIElmIGFjY2Vzc2luZyBwcm90ZWN0ZWQgcm91dGUgd2l0aG91dCBhdXRoZW50aWNhdGlvbiwgcmVkaXJlY3QgdG8gbG9naW5cbiAgICBpZiAoaXNQcm90ZWN0ZWRQYXRoICYmICF1c2VyKSB7XG4gICAgICBjb25zdCByZWRpcmVjdFVybCA9IG5ldyBVUkwoJy9hdXRoL2xvZ2luJywgcmVxdWVzdC51cmwpO1xuICAgICAgcmVkaXJlY3RVcmwuc2VhcmNoUGFyYW1zLnNldCgncmVkaXJlY3QnLCBwYXRobmFtZSk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KHJlZGlyZWN0VXJsKTtcbiAgICB9XG5cbiAgICAvLyBJZiBhY2Nlc3NpbmcgYXV0aCByb3V0ZXMgd2hpbGUgYXV0aGVudGljYXRlZCwgcmVkaXJlY3QgYmFzZWQgb24gcm9sZVxuICAgIGlmIChpc0F1dGhQYXRoICYmIHVzZXIpIHtcbiAgICAgIGlmICh1c2VyUm9sZSA9PT0gJ3N1cGVyX2FkbWluJyB8fCB1c2VyUm9sZSA9PT0gJ3Byb2plY3RfYWRtaW4nIHx8IHVzZXJSb2xlID09PSAndGVhbV9tZW1iZXInKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2FkbWluL3Byb2plY3RzJywgcmVxdWVzdC51cmwpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEZvciBjbGllbnRzLCB3ZSdkIG5lZWQgdG8gZ2V0IHRoZWlyIHByb2plY3QsIHNvIGp1c3QgZ28gdG8gZGFzaGJvYXJkIGZvciBub3dcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvZGFzaGJvYXJkJywgcmVxdWVzdC51cmwpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBGb3IgdGhlIHJvb3QgcGF0aCwgcmVkaXJlY3QgYmFzZWQgb24gYXV0aCBzdGF0dXMgYW5kIHJvbGVcbiAgICBpZiAocGF0aG5hbWUgPT09ICcvJykge1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgaWYgKHVzZXJSb2xlID09PSAnc3VwZXJfYWRtaW4nIHx8IHVzZXJSb2xlID09PSAncHJvamVjdF9hZG1pbicgfHwgdXNlclJvbGUgPT09ICd0ZWFtX21lbWJlcicpIHtcbiAgICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy9hZG1pbi9wcm9qZWN0cycsIHJlcXVlc3QudXJsKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvZGFzaGJvYXJkJywgcmVxdWVzdC51cmwpKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYXV0aC9sb2dpbicsIHJlcXVlc3QudXJsKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvLyBHZXQgY2xpZW50IElQICh3b3JrcyB3aXRoIFZlcmNlbClcbiAgY29uc3QgaXAgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKT8uc3BsaXQoJywnKVswXSB8fCBcbiAgICAgICAgICAgICByZXF1ZXN0LmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKSB8fCBcbiAgICAgICAgICAgICByZXF1ZXN0LmlwIHx8IFxuICAgICAgICAgICAgICd1bmtub3duJztcbiAgXG4gIC8vIEFwcGx5IHJhdGUgbGltaXRpbmcgdG8gQVBJIHJvdXRlc1xuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS8nKSkge1xuICAgIGlmICghY2hlY2tSYXRlTGltaXQoaXAsIHBhdGhuYW1lKSkge1xuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHsgXG4gICAgICAgICAgZXJyb3I6ICdUb28gbWFueSByZXF1ZXN0cy4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlci4nLFxuICAgICAgICAgIHJldHJ5QWZ0ZXI6IDYwIFxuICAgICAgICB9KSxcbiAgICAgICAgeyBcbiAgICAgICAgICBzdGF0dXM6IDQyOSxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICAgJ1JldHJ5LUFmdGVyJzogJzYwJyxcbiAgICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6IFN0cmluZyhnZXRSYXRlTGltaXQocGF0aG5hbWUpLm1heCksXG4gICAgICAgICAgICAnWC1SYXRlTGltaXQtUmVtYWluaW5nJzogJzAnLFxuICAgICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlc2V0JzogU3RyaW5nKERhdGUubm93KCkgKyBSQVRFX0xJTUlUX1dJTkRPVylcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgfVxuICB9XG4gIFxuICAvLyBHZW5lcmF0ZSBhbmQgYXR0YWNoIENTUkYgdG9rZW4gZm9yIHN0YXRlLWNoYW5naW5nIG9wZXJhdGlvbnNcbiAgY29uc3QgY3NyZlRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldCgnY3NyZi10b2tlbicpPy52YWx1ZSB8fCBuYW5vaWQoKTtcbiAgXG4gIC8vIFNldCBzZWN1cml0eSBoZWFkZXJzXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLUNvbnRlbnQtVHlwZS1PcHRpb25zJywgJ25vc25pZmYnKTtcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1gtRnJhbWUtT3B0aW9ucycsICdERU5ZJyk7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLVhTUy1Qcm90ZWN0aW9uJywgJzE7IG1vZGU9YmxvY2snKTtcbiAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ1JlZmVycmVyLVBvbGljeScsICdzdHJpY3Qtb3JpZ2luLXdoZW4tY3Jvc3Mtb3JpZ2luJyk7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdQZXJtaXNzaW9ucy1Qb2xpY3knLCAnY2FtZXJhPSgpLCBtaWNyb3Bob25lPSgpLCBnZW9sb2NhdGlvbj0oKScpO1xuICBcbiAgLy8gQ29udGVudCBTZWN1cml0eSBQb2xpY3lcbiAgY29uc3QgY3NwRGlyZWN0aXZlcyA9IFtcbiAgICBcImRlZmF1bHQtc3JjICdzZWxmJ1wiLFxuICAgIFwic2NyaXB0LXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnICd1bnNhZmUtZXZhbCcgaHR0cHM6Ly92ZXJjZWwubGl2ZVwiLFxuICAgIFwic3R5bGUtc3JjICdzZWxmJyAndW5zYWZlLWlubGluZSdcIixcbiAgICBcImltZy1zcmMgJ3NlbGYnIGRhdGE6IGh0dHBzOiBibG9iOlwiLFxuICAgIFwiZm9udC1zcmMgJ3NlbGYnIGRhdGE6XCIsXG4gICAgXCJjb25uZWN0LXNyYyAnc2VsZicgaHR0cHM6Ly8qLnN1cGFiYXNlLmNvIGh0dHBzOi8vdmVyY2VsLmxpdmUgd3NzOi8vd3MtdXMzLnB1c2hlci5jb21cIixcbiAgICBcImZyYW1lLXNyYyAnc2VsZicgaHR0cHM6Ly92ZXJjZWwubGl2ZVwiLFxuICAgIFwiZm9ybS1hY3Rpb24gJ3NlbGYnXCIsXG4gICAgXCJiYXNlLXVyaSAnc2VsZidcIixcbiAgICBcIm9iamVjdC1zcmMgJ25vbmUnXCIsXG4gICAgXCJmcmFtZS1hbmNlc3RvcnMgJ25vbmUnXCJcbiAgXTtcbiAgXG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdDb250ZW50LVNlY3VyaXR5LVBvbGljeScsIGNzcERpcmVjdGl2ZXMuam9pbignOyAnKSk7XG4gIFxuICAvLyBBbHdheXMgc2V0IENTUkYgdG9rZW4gY29va2llIGlmIGl0IGRvZXNuJ3QgZXhpc3RcbiAgaWYgKCFyZXF1ZXN0LmNvb2tpZXMuZ2V0KCdjc3JmLXRva2VuJykpIHtcbiAgICByZXNwb25zZS5jb29raWVzLnNldCh7XG4gICAgICBuYW1lOiAnY3NyZi10b2tlbicsXG4gICAgICB2YWx1ZTogY3NyZlRva2VuLFxuICAgICAgaHR0cE9ubHk6IGZhbHNlLCAvLyBBbGxvdyBKYXZhU2NyaXB0IHRvIHJlYWQgaXQgZm9yIEFKQVggcmVxdWVzdHNcbiAgICAgIHNlY3VyZTogcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJyxcbiAgICAgIHNhbWVTaXRlOiAnc3RyaWN0JyxcbiAgICAgIHBhdGg6ICcvJyxcbiAgICAgIG1heEFnZTogNjAgKiA2MCAqIDI0IC8vIDI0IGhvdXJzXG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIENPUlMgY29uZmlndXJhdGlvbiBmb3IgQVBJIHJvdXRlc1xuICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS8nKSkge1xuICAgIGNvbnN0IG9yaWdpbiA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ29yaWdpbicpO1xuICAgIGNvbnN0IGFsbG93ZWRPcmlnaW5zID0gW1xuICAgICAgJ2h0dHBzOi8vY3VzdG9tLWZvcm1zLXhpLnZlcmNlbC5hcHAnLFxuICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMCcsXG4gICAgICAnaHR0cDovL2xvY2FsaG9zdDozMDAxJ1xuICAgIF07XG4gICAgXG4gICAgaWYgKG9yaWdpbiAmJiBhbGxvd2VkT3JpZ2lucy5pbmNsdWRlcyhvcmlnaW4pKSB7XG4gICAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJywgb3JpZ2luKTtcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1BbGxvdy1DcmVkZW50aWFscycsICd0cnVlJyk7XG4gICAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctTWV0aG9kcycsICdHRVQsIFBPU1QsIFBVVCwgREVMRVRFLCBPUFRJT05TJyk7XG4gICAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycycsICdDb250ZW50LVR5cGUsIEF1dGhvcml6YXRpb24sIFgtQ1NSRi1Ub2tlbicpO1xuICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLU1heC1BZ2UnLCAnODY0MDAnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIHByZWZsaWdodCByZXF1ZXN0c1xuICAgIGlmIChyZXF1ZXN0Lm1ldGhvZCA9PT0gJ09QVElPTlMnKSB7XG4gICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShudWxsLCB7IHN0YXR1czogMjAwLCBoZWFkZXJzOiByZXNwb25zZS5oZWFkZXJzIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHJlc3BvbnNlO1xufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBtYXRjaGVyOiBbXG4gICAgJy8oKD8hX25leHQvc3RhdGljfF9uZXh0L2ltYWdlfGZhdmljb24uaWNvKS4qKScsXG4gIF0sXG59OyJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJuYW5vaWQiLCJjcmVhdGVTZXJ2ZXJDbGllbnQiLCJyZXF1ZXN0Q291bnRzIiwiTWFwIiwiUkFURV9MSU1JVF9XSU5ET1ciLCJSQVRFX0xJTUlUUyIsIm1heCIsIndpbmRvdyIsImRlZmF1bHQiLCJnZXRSYXRlTGltaXQiLCJwYXRobmFtZSIsInBhdGgiLCJsaW1pdCIsIk9iamVjdCIsImVudHJpZXMiLCJzdGFydHNXaXRoIiwiY2hlY2tSYXRlTGltaXQiLCJpcCIsImtleSIsIm5vdyIsIkRhdGUiLCJoYXMiLCJzZXQiLCJjb3VudCIsInJlc2V0VGltZSIsInJlY29yZCIsImdldCIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwicmVzcG9uc2UiLCJuZXh0IiwiaGVhZGVycyIsIm5leHRVcmwiLCJzdXBhYmFzZVVybCIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJzdXBhYmFzZUtleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfUFVCTElTSEFCTEVfS0VZIiwic3VwYWJhc2UiLCJjb29raWVzIiwibmFtZSIsInZhbHVlIiwib3B0aW9ucyIsImNvb2tpZU9wdGlvbnMiLCJzYW1lU2l0ZSIsInNlY3VyZSIsImh0dHBPbmx5IiwicmVtb3ZlIiwicmVtb3ZlT3B0aW9ucyIsIm1heEFnZSIsImRhdGEiLCJ1c2VyIiwiYXV0aCIsImdldFVzZXIiLCJ1c2VyUm9sZSIsInByb2ZpbGUiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInNpbmdsZSIsInJvbGUiLCJwcm90ZWN0ZWRQYXRocyIsImlzUHJvdGVjdGVkUGF0aCIsInNvbWUiLCJyZWRpcmVjdCIsIlVSTCIsInVybCIsImF1dGhQYXRocyIsImlzQXV0aFBhdGgiLCJyZWRpcmVjdFVybCIsInNlYXJjaFBhcmFtcyIsInNwbGl0IiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwicmV0cnlBZnRlciIsInN0YXR1cyIsIlN0cmluZyIsImNzcmZUb2tlbiIsImNzcERpcmVjdGl2ZXMiLCJqb2luIiwib3JpZ2luIiwiYWxsb3dlZE9yaWdpbnMiLCJpbmNsdWRlcyIsIm1ldGhvZCIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./middleware.js\n");

/***/ })

});