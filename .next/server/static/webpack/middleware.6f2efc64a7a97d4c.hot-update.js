"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.js":
/*!***********************!*\
  !*** ./middleware.js ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var nanoid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! nanoid */ \"(middleware)/./node_modules/nanoid/index.browser.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(middleware)/./node_modules/@supabase/ssr/dist/module/index.js\");\n\n\n\n// Rate limiting implementation\nconst requestCounts = new Map();\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\nconst RATE_LIMITS = {\n    \"/api/responses\": {\n        max: 10,\n        window: RATE_LIMIT_WINDOW\n    },\n    \"/api/forms/upload\": {\n        max: 5,\n        window: RATE_LIMIT_WINDOW\n    },\n    \"/api/ai-analysis\": {\n        max: 5,\n        window: RATE_LIMIT_WINDOW\n    },\n    default: {\n        max: 100,\n        window: RATE_LIMIT_WINDOW\n    } // 100 requests per minute for other endpoints\n};\nfunction getRateLimit(pathname) {\n    for (const [path, limit] of Object.entries(RATE_LIMITS)){\n        if (pathname.startsWith(path)) {\n            return limit;\n        }\n    }\n    return RATE_LIMITS.default;\n}\nfunction checkRateLimit(ip, pathname) {\n    const key = `${ip}:${pathname}`;\n    const limit = getRateLimit(pathname);\n    const now = Date.now();\n    if (!requestCounts.has(key)) {\n        requestCounts.set(key, {\n            count: 1,\n            resetTime: now + limit.window\n        });\n        return true;\n    }\n    const record = requestCounts.get(key);\n    if (now > record.resetTime) {\n        record.count = 1;\n        record.resetTime = now + limit.window;\n        return true;\n    }\n    if (record.count >= limit.max) {\n        return false;\n    }\n    record.count++;\n    return true;\n}\n// Note: In production, use a proper cache like Redis for rate limiting\n// The Map will be cleared on server restart\nasync function middleware(request) {\n    let response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next({\n        request: {\n            headers: request.headers\n        }\n    });\n    const { pathname } = request.nextUrl;\n    // Authentication check for protected routes\n    const supabaseUrl = \"https://eycgzjqwowrdmjlzqqyg.supabase.co\";\n    const supabaseKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImV5Y2d6anF3b3dyZG1qbHpxcXlnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQwODcyMDIsImV4cCI6MjA2OTY2MzIwMn0.QfdUDAF8MweVTmJtrgnPiLWRdXz7hpFIzre-hiVay4E\" || 0;\n    if (supabaseUrl && supabaseKey) {\n        const supabase = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(supabaseUrl, supabaseKey, {\n            cookies: {\n                get (name) {\n                    return request.cookies.get(name)?.value;\n                },\n                set (name, value, options) {\n                    // Ensure proper cookie settings for production\n                    const isProduction = \"development\" === \"production\";\n                    const cookieOptions = {\n                        name,\n                        value,\n                        ...options,\n                        sameSite: isProduction ? \"lax\" : \"lax\",\n                        secure: isProduction,\n                        httpOnly: true,\n                        path: \"/\",\n                        domain: undefined\n                    };\n                    request.cookies.set(cookieOptions);\n                    response.cookies.set(cookieOptions);\n                },\n                remove (name, options) {\n                    const removeOptions = {\n                        name,\n                        value: \"\",\n                        ...options,\n                        maxAge: 0,\n                        path: \"/\"\n                    };\n                    request.cookies.set(removeOptions);\n                    response.cookies.set(removeOptions);\n                }\n            }\n        });\n        // Refresh session if expired\n        const { data: { user } } = await supabase.auth.getUser();\n        // Get user profile if authenticated\n        let userRole = null;\n        if (user) {\n            const { data: profile } = await supabase.from(\"aloa_user_profiles\").select(\"role\").eq(\"id\", user.id).single();\n            userRole = profile?.role;\n        }\n        // Protected routes that require authentication\n        const protectedPaths = [\n            \"/create\",\n            \"/edit\",\n            \"/responses\",\n            \"/ai-analysis\",\n            \"/admin\",\n            \"/profile\",\n            \"/settings\",\n            \"/project\" // Add project routes as protected\n        ];\n        const isProtectedPath = protectedPaths.some((path)=>pathname.startsWith(path));\n        const clientRoles = [\n            \"client\",\n            \"client_admin\",\n            \"client_participant\"\n        ];\n        const adminRoles = [\n            \"super_admin\",\n            \"project_admin\",\n            \"team_member\"\n        ];\n        // No users should access /dashboard anymore - it's deprecated\n        // The /dashboard route itself will handle redirects if someone lands there\n        // Auth routes that should redirect if already logged in\n        const authPaths = [\n            \"/auth/login\",\n            \"/auth/signup\"\n        ];\n        const isAuthPath = authPaths.some((path)=>pathname.startsWith(path));\n        // If accessing protected route without authentication, redirect to login\n        if (isProtectedPath && !user) {\n            const redirectUrl = new URL(\"/auth/login\", request.url);\n            redirectUrl.searchParams.set(\"redirect\", pathname);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(redirectUrl);\n        }\n        // If accessing auth routes while authenticated, redirect based on role\n        if (isAuthPath && user) {\n            if (adminRoles.includes(userRole)) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/projects\", request.url));\n            } else {\n            // For clients, don't redirect - let the login page handle finding their project\n            // This avoids the redirect loop issue\n            // The login page will properly redirect them to their project dashboard\n            }\n        }\n        // For the root path, redirect based on auth status and role\n        if (pathname === \"/\") {\n            if (user) {\n                if (adminRoles.includes(userRole)) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/admin/projects\", request.url));\n                } else {\n                    // For client users, we can't fetch their project here\n                    // So don't redirect - let them stay on login which will handle it\n                    // Or create a client landing page\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/auth/login\", request.url));\n                }\n            } else {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/auth/login\", request.url));\n            }\n        }\n    }\n    // Get client IP (works with Vercel)\n    const ip = request.headers.get(\"x-forwarded-for\")?.split(\",\")[0] || request.headers.get(\"x-real-ip\") || request.ip || \"unknown\";\n    // Apply rate limiting to API routes\n    if (pathname.startsWith(\"/api/\")) {\n        if (!checkRateLimit(ip, pathname)) {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify({\n                error: \"Too many requests. Please try again later.\",\n                retryAfter: 60\n            }), {\n                status: 429,\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"Retry-After\": \"60\",\n                    \"X-RateLimit-Limit\": String(getRateLimit(pathname).max),\n                    \"X-RateLimit-Remaining\": \"0\",\n                    \"X-RateLimit-Reset\": String(Date.now() + RATE_LIMIT_WINDOW)\n                }\n            });\n        }\n    }\n    // Generate and attach CSRF token for state-changing operations\n    const csrfToken = request.cookies.get(\"csrf-token\")?.value || (0,nanoid__WEBPACK_IMPORTED_MODULE_2__.nanoid)();\n    // Set security headers\n    response.headers.set(\"X-Content-Type-Options\", \"nosniff\");\n    response.headers.set(\"X-Frame-Options\", \"DENY\");\n    response.headers.set(\"X-XSS-Protection\", \"1; mode=block\");\n    response.headers.set(\"Referrer-Policy\", \"strict-origin-when-cross-origin\");\n    response.headers.set(\"Permissions-Policy\", \"camera=(), microphone=(), geolocation=()\");\n    // Content Security Policy\n    const cspDirectives = [\n        \"default-src 'self'\",\n        \"script-src 'self' 'unsafe-inline' 'unsafe-eval' https://vercel.live\",\n        \"style-src 'self' 'unsafe-inline'\",\n        \"img-src 'self' data: https: blob:\",\n        \"font-src 'self' data:\",\n        \"connect-src 'self' https://*.supabase.co https://vercel.live wss://ws-us3.pusher.com\",\n        \"frame-src 'self' https://vercel.live\",\n        \"form-action 'self'\",\n        \"base-uri 'self'\",\n        \"object-src 'none'\",\n        \"frame-ancestors 'none'\"\n    ];\n    response.headers.set(\"Content-Security-Policy\", cspDirectives.join(\"; \"));\n    // Always set CSRF token cookie if it doesn't exist\n    if (!request.cookies.get(\"csrf-token\")) {\n        response.cookies.set({\n            name: \"csrf-token\",\n            value: csrfToken,\n            httpOnly: false,\n            secure: \"development\" === \"production\",\n            sameSite: \"strict\",\n            path: \"/\",\n            maxAge: 60 * 60 * 24 // 24 hours\n        });\n    }\n    // CORS configuration for API routes\n    if (pathname.startsWith(\"/api/\")) {\n        const origin = request.headers.get(\"origin\");\n        const allowedOrigins = [\n            \"https://custom-forms-xi.vercel.app\",\n            \"http://localhost:3000\",\n            \"http://localhost:3001\"\n        ];\n        if (origin && allowedOrigins.includes(origin)) {\n            response.headers.set(\"Access-Control-Allow-Origin\", origin);\n            response.headers.set(\"Access-Control-Allow-Credentials\", \"true\");\n            response.headers.set(\"Access-Control-Allow-Methods\", \"GET, POST, PUT, DELETE, OPTIONS\");\n            response.headers.set(\"Access-Control-Allow-Headers\", \"Content-Type, Authorization, X-CSRF-Token\");\n            response.headers.set(\"Access-Control-Max-Age\", \"86400\");\n        }\n        // Handle preflight requests\n        if (request.method === \"OPTIONS\") {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n                status: 200,\n                headers: response.headers\n            });\n        }\n    }\n    return response;\n}\nconst config = {\n    matcher: [\n        \"/((?!_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFLLEdBQUcsV0FBVztRQUNsQztJQUNGO0lBRUEsb0NBQW9DO0lBQ3BDLElBQUk1QyxTQUFTSyxVQUFVLENBQUMsVUFBVTtRQUNoQyxNQUFNMkUsU0FBUzlELFFBQVFHLE9BQU8sQ0FBQ0wsR0FBRyxDQUFDO1FBQ25DLE1BQU1pRSxpQkFBaUI7WUFDckI7WUFDQTtZQUNBO1NBQ0Q7UUFFRCxJQUFJRCxVQUFVQyxlQUFlWixRQUFRLENBQUNXLFNBQVM7WUFDN0M3RCxTQUFTRSxPQUFPLENBQUNULEdBQUcsQ0FBQywrQkFBK0JvRTtZQUNwRDdELFNBQVNFLE9BQU8sQ0FBQ1QsR0FBRyxDQUFDLG9DQUFvQztZQUN6RE8sU0FBU0UsT0FBTyxDQUFDVCxHQUFHLENBQUMsZ0NBQWdDO1lBQ3JETyxTQUFTRSxPQUFPLENBQUNULEdBQUcsQ0FBQyxnQ0FBZ0M7WUFDckRPLFNBQVNFLE9BQU8sQ0FBQ1QsR0FBRyxDQUFDLDBCQUEwQjtRQUNqRDtRQUVBLDRCQUE0QjtRQUM1QixJQUFJTSxRQUFRZ0UsTUFBTSxLQUFLLFdBQVc7WUFDaEMsT0FBTyxJQUFJN0YscURBQVlBLENBQUMsTUFBTTtnQkFBRXNGLFFBQVE7Z0JBQUt0RCxTQUFTRixTQUFTRSxPQUFPO1lBQUM7UUFDekU7SUFDRjtJQUVBLE9BQU9GO0FBQ1Q7QUFFTyxNQUFNZ0UsU0FBUztJQUNwQkMsU0FBUztRQUNQO0tBQ0Q7QUFDSCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL21pZGRsZXdhcmUuanM/M2JjYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBuYW5vaWQgfSBmcm9tICduYW5vaWQnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50IH0gZnJvbSAnQHN1cGFiYXNlL3Nzcic7XG5cbi8vIFJhdGUgbGltaXRpbmcgaW1wbGVtZW50YXRpb25cbmNvbnN0IHJlcXVlc3RDb3VudHMgPSBuZXcgTWFwKCk7XG5jb25zdCBSQVRFX0xJTUlUX1dJTkRPVyA9IDYwICogMTAwMDsgLy8gMSBtaW51dGVcbmNvbnN0IFJBVEVfTElNSVRTID0ge1xuICAnL2FwaS9yZXNwb25zZXMnOiB7IG1heDogMTAsIHdpbmRvdzogUkFURV9MSU1JVF9XSU5ET1cgfSwgLy8gMTAgZm9ybSBzdWJtaXNzaW9ucyBwZXIgbWludXRlXG4gICcvYXBpL2Zvcm1zL3VwbG9hZCc6IHsgbWF4OiA1LCB3aW5kb3c6IFJBVEVfTElNSVRfV0lORE9XIH0sIC8vIDUgZmlsZSB1cGxvYWRzIHBlciBtaW51dGVcbiAgJy9hcGkvYWktYW5hbHlzaXMnOiB7IG1heDogNSwgd2luZG93OiBSQVRFX0xJTUlUX1dJTkRPVyB9LCAvLyA1IEFJIGFuYWx5c2lzIHJlcXVlc3RzIHBlciBtaW51dGVcbiAgZGVmYXVsdDogeyBtYXg6IDEwMCwgd2luZG93OiBSQVRFX0xJTUlUX1dJTkRPVyB9IC8vIDEwMCByZXF1ZXN0cyBwZXIgbWludXRlIGZvciBvdGhlciBlbmRwb2ludHNcbn07XG5cbmZ1bmN0aW9uIGdldFJhdGVMaW1pdChwYXRobmFtZSkge1xuICBmb3IgKGNvbnN0IFtwYXRoLCBsaW1pdF0gb2YgT2JqZWN0LmVudHJpZXMoUkFURV9MSU1JVFMpKSB7XG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgocGF0aCkpIHtcbiAgICAgIHJldHVybiBsaW1pdDtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIFJBVEVfTElNSVRTLmRlZmF1bHQ7XG59XG5cbmZ1bmN0aW9uIGNoZWNrUmF0ZUxpbWl0KGlwLCBwYXRobmFtZSkge1xuICBjb25zdCBrZXkgPSBgJHtpcH06JHtwYXRobmFtZX1gO1xuICBjb25zdCBsaW1pdCA9IGdldFJhdGVMaW1pdChwYXRobmFtZSk7XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIFxuICBpZiAoIXJlcXVlc3RDb3VudHMuaGFzKGtleSkpIHtcbiAgICByZXF1ZXN0Q291bnRzLnNldChrZXksIHsgY291bnQ6IDEsIHJlc2V0VGltZTogbm93ICsgbGltaXQud2luZG93IH0pO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIFxuICBjb25zdCByZWNvcmQgPSByZXF1ZXN0Q291bnRzLmdldChrZXkpO1xuICBcbiAgaWYgKG5vdyA+IHJlY29yZC5yZXNldFRpbWUpIHtcbiAgICByZWNvcmQuY291bnQgPSAxO1xuICAgIHJlY29yZC5yZXNldFRpbWUgPSBub3cgKyBsaW1pdC53aW5kb3c7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgXG4gIGlmIChyZWNvcmQuY291bnQgPj0gbGltaXQubWF4KSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIFxuICByZWNvcmQuY291bnQrKztcbiAgcmV0dXJuIHRydWU7XG59XG5cbi8vIE5vdGU6IEluIHByb2R1Y3Rpb24sIHVzZSBhIHByb3BlciBjYWNoZSBsaWtlIFJlZGlzIGZvciByYXRlIGxpbWl0aW5nXG4vLyBUaGUgTWFwIHdpbGwgYmUgY2xlYXJlZCBvbiBzZXJ2ZXIgcmVzdGFydFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0KSB7XG4gIGxldCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5uZXh0KHtcbiAgICByZXF1ZXN0OiB7XG4gICAgICBoZWFkZXJzOiByZXF1ZXN0LmhlYWRlcnMsXG4gICAgfSxcbiAgfSk7XG4gIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHJlcXVlc3QubmV4dFVybDtcbiAgXG4gIC8vIEF1dGhlbnRpY2F0aW9uIGNoZWNrIGZvciBwcm90ZWN0ZWQgcm91dGVzXG4gIGNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMO1xuICBjb25zdCBzdXBhYmFzZUtleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1BVQkxJU0hBQkxFX0tFWTtcbiAgXG4gIGlmIChzdXBhYmFzZVVybCAmJiBzdXBhYmFzZUtleSkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgICAgc3VwYWJhc2VVcmwsXG4gICAgICBzdXBhYmFzZUtleSxcbiAgICAgIHtcbiAgICAgICAgY29va2llczoge1xuICAgICAgICAgIGdldChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC5jb29raWVzLmdldChuYW1lKT8udmFsdWU7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzZXQobmFtZSwgdmFsdWUsIG9wdGlvbnMpIHtcbiAgICAgICAgICAgIC8vIEVuc3VyZSBwcm9wZXIgY29va2llIHNldHRpbmdzIGZvciBwcm9kdWN0aW9uXG4gICAgICAgICAgICBjb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nO1xuICAgICAgICAgICAgY29uc3QgY29va2llT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICAgIHNhbWVTaXRlOiBpc1Byb2R1Y3Rpb24gPyAnbGF4JyA6ICdsYXgnLFxuICAgICAgICAgICAgICBzZWN1cmU6IGlzUHJvZHVjdGlvbixcbiAgICAgICAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgICAgICAgIHBhdGg6ICcvJyxcbiAgICAgICAgICAgICAgZG9tYWluOiB1bmRlZmluZWRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXF1ZXN0LmNvb2tpZXMuc2V0KGNvb2tpZU9wdGlvbnMpO1xuICAgICAgICAgICAgcmVzcG9uc2UuY29va2llcy5zZXQoY29va2llT3B0aW9ucyk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICByZW1vdmUobmFtZSwgb3B0aW9ucykge1xuICAgICAgICAgICAgY29uc3QgcmVtb3ZlT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICAgICAgICAuLi5vcHRpb25zLFxuICAgICAgICAgICAgICBtYXhBZ2U6IDAsXG4gICAgICAgICAgICAgIHBhdGg6ICcvJ1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJlcXVlc3QuY29va2llcy5zZXQocmVtb3ZlT3B0aW9ucyk7XG4gICAgICAgICAgICByZXNwb25zZS5jb29raWVzLnNldChyZW1vdmVPcHRpb25zKTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfVxuICAgICk7XG5cbiAgICAvLyBSZWZyZXNoIHNlc3Npb24gaWYgZXhwaXJlZFxuICAgIGNvbnN0IHsgZGF0YTogeyB1c2VyIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuICAgIFxuICAgIC8vIEdldCB1c2VyIHByb2ZpbGUgaWYgYXV0aGVudGljYXRlZFxuICAgIGxldCB1c2VyUm9sZSA9IG51bGw7XG4gICAgaWYgKHVzZXIpIHtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2Fsb2FfdXNlcl9wcm9maWxlcycpXG4gICAgICAgIC5zZWxlY3QoJ3JvbGUnKVxuICAgICAgICAuZXEoJ2lkJywgdXNlci5pZClcbiAgICAgICAgLnNpbmdsZSgpO1xuICAgICAgXG4gICAgICB1c2VyUm9sZSA9IHByb2ZpbGU/LnJvbGU7XG4gICAgfVxuXG4gICAgLy8gUHJvdGVjdGVkIHJvdXRlcyB0aGF0IHJlcXVpcmUgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCBwcm90ZWN0ZWRQYXRocyA9IFtcbiAgICAgICcvY3JlYXRlJyxcbiAgICAgICcvZWRpdCcsXG4gICAgICAnL3Jlc3BvbnNlcycsXG4gICAgICAnL2FpLWFuYWx5c2lzJyxcbiAgICAgICcvYWRtaW4nLFxuICAgICAgJy9wcm9maWxlJyxcbiAgICAgICcvc2V0dGluZ3MnLFxuICAgICAgJy9wcm9qZWN0JyAgLy8gQWRkIHByb2plY3Qgcm91dGVzIGFzIHByb3RlY3RlZFxuICAgIF07XG5cbiAgICBjb25zdCBpc1Byb3RlY3RlZFBhdGggPSBwcm90ZWN0ZWRQYXRocy5zb21lKHBhdGggPT4gXG4gICAgICBwYXRobmFtZS5zdGFydHNXaXRoKHBhdGgpXG4gICAgKTtcbiAgICBcbiAgICBjb25zdCBjbGllbnRSb2xlcyA9IFsnY2xpZW50JywgJ2NsaWVudF9hZG1pbicsICdjbGllbnRfcGFydGljaXBhbnQnXTtcbiAgICBjb25zdCBhZG1pblJvbGVzID0gWydzdXBlcl9hZG1pbicsICdwcm9qZWN0X2FkbWluJywgJ3RlYW1fbWVtYmVyJ107XG5cbiAgICAvLyBObyB1c2VycyBzaG91bGQgYWNjZXNzIC9kYXNoYm9hcmQgYW55bW9yZSAtIGl0J3MgZGVwcmVjYXRlZFxuICAgIC8vIFRoZSAvZGFzaGJvYXJkIHJvdXRlIGl0c2VsZiB3aWxsIGhhbmRsZSByZWRpcmVjdHMgaWYgc29tZW9uZSBsYW5kcyB0aGVyZVxuXG4gICAgLy8gQXV0aCByb3V0ZXMgdGhhdCBzaG91bGQgcmVkaXJlY3QgaWYgYWxyZWFkeSBsb2dnZWQgaW5cbiAgICBjb25zdCBhdXRoUGF0aHMgPSBbJy9hdXRoL2xvZ2luJywgJy9hdXRoL3NpZ251cCddO1xuICAgIGNvbnN0IGlzQXV0aFBhdGggPSBhdXRoUGF0aHMuc29tZShwYXRoID0+IFxuICAgICAgcGF0aG5hbWUuc3RhcnRzV2l0aChwYXRoKVxuICAgICk7XG5cbiAgICAvLyBJZiBhY2Nlc3NpbmcgcHJvdGVjdGVkIHJvdXRlIHdpdGhvdXQgYXV0aGVudGljYXRpb24sIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgaWYgKGlzUHJvdGVjdGVkUGF0aCAmJiAhdXNlcikge1xuICAgICAgY29uc3QgcmVkaXJlY3RVcmwgPSBuZXcgVVJMKCcvYXV0aC9sb2dpbicsIHJlcXVlc3QudXJsKTtcbiAgICAgIHJlZGlyZWN0VXJsLnNlYXJjaFBhcmFtcy5zZXQoJ3JlZGlyZWN0JywgcGF0aG5hbWUpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChyZWRpcmVjdFVybCk7XG4gICAgfVxuXG4gICAgLy8gSWYgYWNjZXNzaW5nIGF1dGggcm91dGVzIHdoaWxlIGF1dGhlbnRpY2F0ZWQsIHJlZGlyZWN0IGJhc2VkIG9uIHJvbGVcbiAgICBpZiAoaXNBdXRoUGF0aCAmJiB1c2VyKSB7XG4gICAgICBpZiAoYWRtaW5Sb2xlcy5pbmNsdWRlcyh1c2VyUm9sZSkpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYWRtaW4vcHJvamVjdHMnLCByZXF1ZXN0LnVybCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIGNsaWVudHMsIGRvbid0IHJlZGlyZWN0IC0gbGV0IHRoZSBsb2dpbiBwYWdlIGhhbmRsZSBmaW5kaW5nIHRoZWlyIHByb2plY3RcbiAgICAgICAgLy8gVGhpcyBhdm9pZHMgdGhlIHJlZGlyZWN0IGxvb3AgaXNzdWVcbiAgICAgICAgLy8gVGhlIGxvZ2luIHBhZ2Ugd2lsbCBwcm9wZXJseSByZWRpcmVjdCB0aGVtIHRvIHRoZWlyIHByb2plY3QgZGFzaGJvYXJkXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRm9yIHRoZSByb290IHBhdGgsIHJlZGlyZWN0IGJhc2VkIG9uIGF1dGggc3RhdHVzIGFuZCByb2xlXG4gICAgaWYgKHBhdGhuYW1lID09PSAnLycpIHtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIGlmIChhZG1pblJvbGVzLmluY2x1ZGVzKHVzZXJSb2xlKSkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2FkbWluL3Byb2plY3RzJywgcmVxdWVzdC51cmwpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBGb3IgY2xpZW50IHVzZXJzLCB3ZSBjYW4ndCBmZXRjaCB0aGVpciBwcm9qZWN0IGhlcmVcbiAgICAgICAgICAvLyBTbyBkb24ndCByZWRpcmVjdCAtIGxldCB0aGVtIHN0YXkgb24gbG9naW4gd2hpY2ggd2lsbCBoYW5kbGUgaXRcbiAgICAgICAgICAvLyBPciBjcmVhdGUgYSBjbGllbnQgbGFuZGluZyBwYWdlXG4gICAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvYXV0aC9sb2dpbicsIHJlcXVlc3QudXJsKSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL2F1dGgvbG9naW4nLCByZXF1ZXN0LnVybCkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgLy8gR2V0IGNsaWVudCBJUCAod29ya3Mgd2l0aCBWZXJjZWwpXG4gIGNvbnN0IGlwID0gcmVxdWVzdC5oZWFkZXJzLmdldCgneC1mb3J3YXJkZWQtZm9yJyk/LnNwbGl0KCcsJylbMF0gfHwgXG4gICAgICAgICAgICAgcmVxdWVzdC5oZWFkZXJzLmdldCgneC1yZWFsLWlwJykgfHwgXG4gICAgICAgICAgICAgcmVxdWVzdC5pcCB8fCBcbiAgICAgICAgICAgICAndW5rbm93bic7XG4gIFxuICAvLyBBcHBseSByYXRlIGxpbWl0aW5nIHRvIEFQSSByb3V0ZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvJykpIHtcbiAgICBpZiAoIWNoZWNrUmF0ZUxpbWl0KGlwLCBwYXRobmFtZSkpIHtcbiAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7IFxuICAgICAgICAgIGVycm9yOiAnVG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuJyxcbiAgICAgICAgICByZXRyeUFmdGVyOiA2MCBcbiAgICAgICAgfSksXG4gICAgICAgIHsgXG4gICAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdSZXRyeS1BZnRlcic6ICc2MCcsXG4gICAgICAgICAgICAnWC1SYXRlTGltaXQtTGltaXQnOiBTdHJpbmcoZ2V0UmF0ZUxpbWl0KHBhdGhuYW1lKS5tYXgpLFxuICAgICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlbWFpbmluZyc6ICcwJyxcbiAgICAgICAgICAgICdYLVJhdGVMaW1pdC1SZXNldCc6IFN0cmluZyhEYXRlLm5vdygpICsgUkFURV9MSU1JVF9XSU5ET1cpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gR2VuZXJhdGUgYW5kIGF0dGFjaCBDU1JGIHRva2VuIGZvciBzdGF0ZS1jaGFuZ2luZyBvcGVyYXRpb25zXG4gIGNvbnN0IGNzcmZUb2tlbiA9IHJlcXVlc3QuY29va2llcy5nZXQoJ2NzcmYtdG9rZW4nKT8udmFsdWUgfHwgbmFub2lkKCk7XG4gIFxuICAvLyBTZXQgc2VjdXJpdHkgaGVhZGVyc1xuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1Db250ZW50LVR5cGUtT3B0aW9ucycsICdub3NuaWZmJyk7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdYLUZyYW1lLU9wdGlvbnMnLCAnREVOWScpO1xuICByZXNwb25zZS5oZWFkZXJzLnNldCgnWC1YU1MtUHJvdGVjdGlvbicsICcxOyBtb2RlPWJsb2NrJyk7XG4gIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdSZWZlcnJlci1Qb2xpY3knLCAnc3RyaWN0LW9yaWdpbi13aGVuLWNyb3NzLW9yaWdpbicpO1xuICByZXNwb25zZS5oZWFkZXJzLnNldCgnUGVybWlzc2lvbnMtUG9saWN5JywgJ2NhbWVyYT0oKSwgbWljcm9waG9uZT0oKSwgZ2VvbG9jYXRpb249KCknKTtcbiAgXG4gIC8vIENvbnRlbnQgU2VjdXJpdHkgUG9saWN5XG4gIGNvbnN0IGNzcERpcmVjdGl2ZXMgPSBbXG4gICAgXCJkZWZhdWx0LXNyYyAnc2VsZidcIixcbiAgICBcInNjcmlwdC1zcmMgJ3NlbGYnICd1bnNhZmUtaW5saW5lJyAndW5zYWZlLWV2YWwnIGh0dHBzOi8vdmVyY2VsLmxpdmVcIixcbiAgICBcInN0eWxlLXNyYyAnc2VsZicgJ3Vuc2FmZS1pbmxpbmUnXCIsXG4gICAgXCJpbWctc3JjICdzZWxmJyBkYXRhOiBodHRwczogYmxvYjpcIixcbiAgICBcImZvbnQtc3JjICdzZWxmJyBkYXRhOlwiLFxuICAgIFwiY29ubmVjdC1zcmMgJ3NlbGYnIGh0dHBzOi8vKi5zdXBhYmFzZS5jbyBodHRwczovL3ZlcmNlbC5saXZlIHdzczovL3dzLXVzMy5wdXNoZXIuY29tXCIsXG4gICAgXCJmcmFtZS1zcmMgJ3NlbGYnIGh0dHBzOi8vdmVyY2VsLmxpdmVcIixcbiAgICBcImZvcm0tYWN0aW9uICdzZWxmJ1wiLFxuICAgIFwiYmFzZS11cmkgJ3NlbGYnXCIsXG4gICAgXCJvYmplY3Qtc3JjICdub25lJ1wiLFxuICAgIFwiZnJhbWUtYW5jZXN0b3JzICdub25lJ1wiXG4gIF07XG4gIFxuICByZXNwb25zZS5oZWFkZXJzLnNldCgnQ29udGVudC1TZWN1cml0eS1Qb2xpY3knLCBjc3BEaXJlY3RpdmVzLmpvaW4oJzsgJykpO1xuICBcbiAgLy8gQWx3YXlzIHNldCBDU1JGIHRva2VuIGNvb2tpZSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gIGlmICghcmVxdWVzdC5jb29raWVzLmdldCgnY3NyZi10b2tlbicpKSB7XG4gICAgcmVzcG9uc2UuY29va2llcy5zZXQoe1xuICAgICAgbmFtZTogJ2NzcmYtdG9rZW4nLFxuICAgICAgdmFsdWU6IGNzcmZUb2tlbixcbiAgICAgIGh0dHBPbmx5OiBmYWxzZSwgLy8gQWxsb3cgSmF2YVNjcmlwdCB0byByZWFkIGl0IGZvciBBSkFYIHJlcXVlc3RzXG4gICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicsXG4gICAgICBzYW1lU2l0ZTogJ3N0cmljdCcsXG4gICAgICBwYXRoOiAnLycsXG4gICAgICBtYXhBZ2U6IDYwICogNjAgKiAyNCAvLyAyNCBob3Vyc1xuICAgIH0pO1xuICB9XG4gIFxuICAvLyBDT1JTIGNvbmZpZ3VyYXRpb24gZm9yIEFQSSByb3V0ZXNcbiAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvJykpIHtcbiAgICBjb25zdCBvcmlnaW4gPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdvcmlnaW4nKTtcbiAgICBjb25zdCBhbGxvd2VkT3JpZ2lucyA9IFtcbiAgICAgICdodHRwczovL2N1c3RvbS1mb3Jtcy14aS52ZXJjZWwuYXBwJyxcbiAgICAgICdodHRwOi8vbG9jYWxob3N0OjMwMDAnLFxuICAgICAgJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMSdcbiAgICBdO1xuICAgIFxuICAgIGlmIChvcmlnaW4gJiYgYWxsb3dlZE9yaWdpbnMuaW5jbHVkZXMob3JpZ2luKSkge1xuICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbicsIG9yaWdpbik7XG4gICAgICByZXNwb25zZS5oZWFkZXJzLnNldCgnQWNjZXNzLUNvbnRyb2wtQWxsb3ctQ3JlZGVudGlhbHMnLCAndHJ1ZScpO1xuICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnLCAnR0VULCBQT1NULCBQVVQsIERFTEVURSwgT1BUSU9OUycpO1xuICAgICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnLCAnQ29udGVudC1UeXBlLCBBdXRob3JpemF0aW9uLCBYLUNTUkYtVG9rZW4nKTtcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCdBY2Nlc3MtQ29udHJvbC1NYXgtQWdlJywgJzg2NDAwJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEhhbmRsZSBwcmVmbGlnaHQgcmVxdWVzdHNcbiAgICBpZiAocmVxdWVzdC5tZXRob2QgPT09ICdPUFRJT05TJykge1xuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UobnVsbCwgeyBzdGF0dXM6IDIwMCwgaGVhZGVyczogcmVzcG9uc2UuaGVhZGVycyB9KTtcbiAgICB9XG4gIH1cbiAgXG4gIHJldHVybiByZXNwb25zZTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgICcvKCg/IV9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKiknLFxuICBdLFxufTsiXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwibmFub2lkIiwiY3JlYXRlU2VydmVyQ2xpZW50IiwicmVxdWVzdENvdW50cyIsIk1hcCIsIlJBVEVfTElNSVRfV0lORE9XIiwiUkFURV9MSU1JVFMiLCJtYXgiLCJ3aW5kb3ciLCJkZWZhdWx0IiwiZ2V0UmF0ZUxpbWl0IiwicGF0aG5hbWUiLCJwYXRoIiwibGltaXQiLCJPYmplY3QiLCJlbnRyaWVzIiwic3RhcnRzV2l0aCIsImNoZWNrUmF0ZUxpbWl0IiwiaXAiLCJrZXkiLCJub3ciLCJEYXRlIiwiaGFzIiwic2V0IiwiY291bnQiLCJyZXNldFRpbWUiLCJyZWNvcmQiLCJnZXQiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsInJlc3BvbnNlIiwibmV4dCIsImhlYWRlcnMiLCJuZXh0VXJsIiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1BVQkxJU0hBQkxFX0tFWSIsInN1cGFiYXNlIiwiY29va2llcyIsIm5hbWUiLCJ2YWx1ZSIsIm9wdGlvbnMiLCJpc1Byb2R1Y3Rpb24iLCJjb29raWVPcHRpb25zIiwic2FtZVNpdGUiLCJzZWN1cmUiLCJodHRwT25seSIsImRvbWFpbiIsInVuZGVmaW5lZCIsInJlbW92ZSIsInJlbW92ZU9wdGlvbnMiLCJtYXhBZ2UiLCJkYXRhIiwidXNlciIsImF1dGgiLCJnZXRVc2VyIiwidXNlclJvbGUiLCJwcm9maWxlIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJzaW5nbGUiLCJyb2xlIiwicHJvdGVjdGVkUGF0aHMiLCJpc1Byb3RlY3RlZFBhdGgiLCJzb21lIiwiY2xpZW50Um9sZXMiLCJhZG1pblJvbGVzIiwiYXV0aFBhdGhzIiwiaXNBdXRoUGF0aCIsInJlZGlyZWN0VXJsIiwiVVJMIiwidXJsIiwic2VhcmNoUGFyYW1zIiwicmVkaXJlY3QiLCJpbmNsdWRlcyIsInNwbGl0IiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwicmV0cnlBZnRlciIsInN0YXR1cyIsIlN0cmluZyIsImNzcmZUb2tlbiIsImNzcERpcmVjdGl2ZXMiLCJqb2luIiwib3JpZ2luIiwiYWxsb3dlZE9yaWdpbnMiLCJtZXRob2QiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.js\n");

/***/ })

});