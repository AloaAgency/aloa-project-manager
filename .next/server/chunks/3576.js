"use strict";exports.id=3576,exports.ids=[3576],exports.modules={43576:(e,a,s)=>{s.d(a,{Z:()=>w});var t=s(10326),l=s(17577);s(24420);var r=s(55795),o=s(88129),n=s(41135),i=s(31009);function c(...e){return(0,i.m6)((0,n.W)(e))}let d={variant:{default:"bg-aloa-black text-aloa-cream hover:bg-opacity-90 shadow-lg hover:shadow-xl transition-all duration-300 uppercase tracking-wider font-medium",destructive:"bg-red-600 text-white hover:bg-red-700 transition-all duration-300",outline:"border-2 border-aloa-black bg-transparent text-aloa-black hover:bg-aloa-black hover:text-aloa-cream transition-all duration-300 uppercase tracking-wider font-medium",secondary:"bg-aloa-sand text-aloa-black hover:bg-aloa-gray hover:text-aloa-cream transition-all duration-300",ghost:"hover:bg-aloa-sand transition-all duration-300",link:"text-aloa-black underline-offset-4 hover:underline"},size:{default:"h-12 px-6 py-3",sm:"h-10 px-4 py-2 text-sm",lg:"h-14 px-8 py-4 text-lg",icon:"h-12 w-12"}},m=l.forwardRef(({className:e,variant:a="default",size:s="default",...l},r)=>t.jsx("button",{className:c("inline-flex items-center justify-center font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-aloa-black focus-visible:ring-offset-2 focus-visible:ring-offset-aloa-cream disabled:opacity-50 disabled:pointer-events-none transform hover:-translate-y-0.5",d.variant[a],d.size[s],e),ref:r,...l}));m.displayName="Button";let u=l.forwardRef(({className:e,type:a,...s},l)=>t.jsx("input",{type:a,className:c("flex h-12 w-full bg-aloa-white border-2 border-aloa-black px-4 py-3 text-base transition-all duration-200","placeholder:text-aloa-gray","focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream","hover:shadow-md","disabled:cursor-not-allowed disabled:opacity-50",e),ref:l,...s}));u.displayName="Input";let f=l.forwardRef(({className:e,...a},s)=>t.jsx("textarea",{className:c("flex min-h-[120px] w-full bg-aloa-white border-2 border-aloa-black px-4 py-3 text-base transition-all duration-200","placeholder:text-aloa-gray","focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream","hover:shadow-md","disabled:cursor-not-allowed disabled:opacity-50","resize-y",e),ref:s,...a}));f.displayName="Textarea";var x=s(34478);let h=l.forwardRef(({className:e,...a},s)=>t.jsx(x.f,{ref:s,className:c("text-sm font-medium text-aloa-black uppercase tracking-wider leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",e),...a}));h.displayName=x.f.displayName;var p=s(33734),b=s(39183),g=s(30361),y=s(11890),j=s(69436),v=s(13635),N=s(65257),k=s(18168);function w({form:e,isModal:a=!1,onComplete:s,initialData:n,initialSection:i,onProgressChange:c,isViewOnly:d=!1}){e._id||e.urlId;let[x,w]=(0,l.useState)(()=>a&&void 0!==i?i:0),[$,C]=(0,l.useState)(()=>a&&n?n:{}),[S,A]=(0,l.useState)(!1),[Z,z]=(0,l.useState)(!1),[E,F]=(0,l.useState)({}),[I,M]=(0,l.useState)(!1);if(!e||!e.fields||!Array.isArray(e.fields))return console.error("Form fields are missing or invalid:",e),t.jsx("div",{children:"Error: Form fields not properly loaded"});let R=e.fields.reduce((e,a)=>{let s=a.section||"General Information";return e[s]||(e[s]=[]),e[s].push(a),e},{}),T=Object.keys(R).filter(e=>R[e].length>0),O=R[T[x]]||[],V=()=>{let e={},a=!0;return O.forEach(s=>{s.required&&!$[s.name]&&(e[s.name]="This field is required",a=!1)}),F(e),a},q=e=>{if(e?.preventDefault(),console.log("handleNext called - currentSection:",x,"sectionNames:",T),!V()){console.log("Validation failed");return}x<T.length-1?(console.log("Moving to next section:",x+1),w(x+1),F({})):console.log("Already at last section")},D=async t=>{if(t.preventDefault(),V()){if(z(!0),console.log("Submitting form data:",$),console.log("Form ID:",e._id),a&&s){try{await s($),A(!0)}catch(e){console.error("Submit error:",e)}finally{z(!1)}return}try{let a=document.cookie.split("; ").find(e=>e.startsWith("csrf-token="))?.split("=")[1],s=await fetch("/api/aloa-responses",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":a||""},credentials:"same-origin",body:JSON.stringify({formId:e._id,data:$})});if(s.ok){let e=await s.json();console.log("Response saved successfully:",e),A(!0)}else{let e=await s.text();console.error("Failed to save response:",e)}}catch(e){console.error("Submit error:",e)}finally{z(!1)}}},Y=e=>{if(d){let a=$[e.name];if(!a||Array.isArray(a)&&0===a.length)return t.jsx("div",{className:"text-gray-500 italic",children:"No response provided"});let s=a;if(Array.isArray(a))s=a.join(", ");else if("rating"===e.type){let s=e.validation?.max||5;return(0,t.jsxs)("div",{className:"flex gap-1",children:[[...Array(s)].map((e,s)=>t.jsx(p.Z,{className:`h-5 w-5 ${s<parseInt(a)?"fill-yellow-500 text-yellow-500":"text-gray-300"}`},s)),(0,t.jsxs)("span",{className:"ml-2 text-sm text-gray-600",children:["(",a,"/",s,")"]})]})}return t.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:t.jsx("p",{className:"text-gray-800",children:s})})}let a={id:e.name,name:e.name,placeholder:e.placeholder,required:e.required,onChange:a=>C({...$,[e.name]:a.target.value}),value:$[e.name]||"",className:E[e.name]?"border-red-500":""};switch(e.type){case"text":case"email":case"tel":case"url":case"number":case"date":return t.jsx(u,{type:e.type,...a});case"textarea":return t.jsx(f,{...a});case"select":return(0,t.jsxs)(k.fC,{value:$[e.name]||"",onValueChange:a=>C({...$,[e.name]:a}),children:[(0,t.jsxs)(k.xz,{className:"flex h-12 w-full items-center justify-between bg-aloa-white border-2 border-aloa-black px-4 py-3 text-base hover:shadow-md focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream transition-all duration-200",children:[t.jsx(k.B4,{placeholder:e.placeholder||"Select an option"}),t.jsx(k.JO,{className:"ml-2",children:t.jsx(b.Z,{className:"h-4 w-4 rotate-90"})})]}),t.jsx(k.h_,{children:t.jsx(k.VY,{className:"overflow-hidden bg-aloa-white border-2 border-aloa-black shadow-xl",style:{zIndex:1e4},position:"popper",sideOffset:5,children:t.jsx(k.l_,{className:"p-1",children:e.options?.map(e=>t.jsx(k.ck,{value:e,className:"relative flex cursor-pointer select-none items-center px-8 py-2 text-base hover:bg-aloa-sand focus:bg-aloa-sand focus:outline-none transition-colors duration-200",children:t.jsx(k.eT,{children:e})},e))})})})]});case"radio":return t.jsx(N.fC,{value:$[e.name]||"",onValueChange:a=>C({...$,[e.name]:a}),className:"space-y-2",children:e.options?.map(a=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(N.ck,{value:a,id:`${e.name}-${a}`,className:"h-5 w-5 rounded-full border-2 border-aloa-black hover:shadow-md focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream transition-all duration-200",children:t.jsx(N.z$,{className:"relative flex h-full w-full items-center justify-center after:block after:h-2.5 after:w-2.5 after:rounded-full after:bg-aloa-black"})}),t.jsx("label",{htmlFor:`${e.name}-${a}`,className:"text-sm font-medium text-aloa-black cursor-pointer",children:a})]},a))});case"checkbox":case"multiselect":if(!e.options||0===e.options.length)return(0,t.jsxs)("div",{className:"text-gray-500 italic",children:["No options available for ",e.label||e.name]});return t.jsx("div",{className:"space-y-2",children:e.options.map(a=>{let s=Array.isArray($[e.name])?$[e.name]:[],l=s.includes(a);return(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[t.jsx(v.fC,{id:`${e.name}-${a}`,checked:l,onCheckedChange:t=>{let l=t?[...s,a]:s.filter(e=>e!==a);C({...$,[e.name]:l})},className:"h-5 w-5 border-2 border-aloa-black bg-aloa-white data-[state=checked]:bg-aloa-black hover:shadow-md focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream transition-all duration-200",children:t.jsx(v.z$,{className:"flex items-center justify-center text-aloa-cream",children:t.jsx(g.Z,{className:"h-4 w-4"})})}),t.jsx("label",{htmlFor:`${e.name}-${a}`,className:"text-sm font-medium text-aloa-black cursor-pointer select-none",onClick:s=>{s.preventDefault();let t=document.getElementById(`${e.name}-${a}`);if(t){let e=new MouseEvent("click",{bubbles:!0});t.dispatchEvent(e)}},children:a})]},a)})});case"rating":let s=e.validation?.max||5,l=parseInt($[e.name])||0;return t.jsx("div",{className:"flex gap-2",children:[...Array(s)].map((a,r)=>t.jsx("button",{type:"button",onClick:()=>C({...$,[e.name]:String(r+1)}),className:"p-1 transition-all duration-200 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream","aria-label":`Rate ${r+1} out of ${s}`,children:t.jsx(p.Z,{className:`h-8 w-8 ${r<l?"fill-aloa-black text-aloa-black":"text-aloa-gray hover:text-aloa-black"}`})},r+1))});case"multiselect":let r=$[e.name]||[];return t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border-2 border-aloa-black p-3",children:e.options?.map(a=>t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(v.fC,{id:`${e.name}-${a}`,checked:r.includes(a),onCheckedChange:s=>{let t=s?[...r,a]:r.filter(e=>e!==a);C({...$,[e.name]:t})},className:"h-5 w-5 border-2 border-aloa-black hover:shadow-md focus:outline-none focus:ring-2 focus:ring-aloa-black focus:ring-offset-2 focus:ring-offset-aloa-cream transition-all duration-200",children:t.jsx(v.z$,{className:"flex items-center justify-center text-aloa-black",children:t.jsx(g.Z,{className:"h-4 w-4"})})}),t.jsx("label",{htmlFor:`${e.name}-${a}`,className:"text-sm font-medium text-aloa-black cursor-pointer",children:a})]},a))});case"phone":return t.jsx(u,{type:"tel",...a});default:return t.jsx(u,{type:"text",...a})}};return S?(0,t.jsxs)(r.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center min-h-[400px] text-center p-8",children:[t.jsx("div",{className:"bg-aloa-black text-aloa-cream p-4 rounded-full mb-6",children:t.jsx(g.Z,{className:"h-16 w-16"})}),t.jsx("h2",{className:"text-3xl font-display font-bold text-aloa-black mb-3 uppercase tracking-wider",children:"Thank You!"}),t.jsx("p",{className:"text-lg text-aloa-gray font-body",children:"Your response has been successfully submitted."})]}):(0,t.jsxs)("div",{className:"max-w-3xl mx-auto p-6",children:[I&&t.jsx(r.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"mb-6 p-4 bg-aloa-sand border-2 border-aloa-black",children:t.jsx("p",{className:"text-aloa-black font-body",children:"✨ Your previous progress has been restored. You can continue where you left off."})}),(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-3",children:[(0,t.jsxs)("span",{className:"text-sm font-display uppercase tracking-wider text-aloa-gray",children:["Step ",x+1," of ",T.length]}),(0,t.jsxs)("span",{className:"text-sm font-display uppercase tracking-wider text-aloa-gray",children:[T.length>0?Math.round((x+1)/T.length*100):0,"% Complete"]})]}),t.jsx("div",{className:"w-full bg-aloa-sand h-3 border-2 border-aloa-black",children:t.jsx(r.E.div,{className:"bg-aloa-black h-full",initial:{width:0},animate:{width:T.length>0?`${(x+1)/T.length*100}%`:"0%"},transition:{duration:.5}})})]}),(0,t.jsxs)("div",{className:"mb-8",children:[d&&(0,t.jsxs)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg flex items-center gap-2",children:[(0,t.jsxs)("svg",{className:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),t.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Viewing your submitted response (read-only)"})]}),t.jsx("h1",{className:"text-3xl font-display font-bold text-aloa-black mb-2 uppercase tracking-tight",children:e.title}),e.description&&t.jsx("p",{className:"text-aloa-gray font-body",children:e.description})]}),(0,t.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"mb-6",children:[t.jsx("h2",{className:"text-xl font-display font-bold text-aloa-black mb-2 uppercase tracking-wider",children:T[x]}),t.jsx("div",{className:"h-1 w-24 bg-aloa-black"})]},x),(0,t.jsxs)("form",{onSubmit:e=>{e.preventDefault(),x===T.length-1?D(e):q(e)},children:[t.jsx(o.M,{mode:"wait",children:t.jsx(r.E.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-6",children:O.map(e=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(h,{htmlFor:e.name,children:[e.label,e.required&&t.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),Y(e),E[e.name]&&t.jsx("p",{className:"text-sm text-red-600 mt-1 font-body",children:E[e.name]})]},e.name))},x)}),(0,t.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,t.jsxs)(m,{type:"button",variant:"outline",onClick:()=>{x>0&&(w(x-1),F({}))},disabled:0===x,className:"flex items-center gap-2",children:[t.jsx(y.Z,{className:"h-4 w-4"}),"Previous"]}),d?x<T.length-1?(0,t.jsxs)(m,{type:"button",onClick:q,className:"flex items-center gap-2",children:["Next",t.jsx(b.Z,{className:"h-4 w-4"})]}):t.jsx("div",{className:"flex items-center gap-2 text-gray-600",children:t.jsx("span",{className:"text-sm font-medium",children:"View Only Mode"})}):x===T.length-1?(0,t.jsxs)(m,{type:"submit",disabled:Z,className:"flex items-center gap-2",children:[Z?"Submitting...":"Submit",t.jsx(j.Z,{className:"h-4 w-4"})]}):(0,t.jsxs)(m,{type:"submit",className:"flex items-center gap-2",children:["Next",t.jsx(b.Z,{className:"h-4 w-4"})]})]})]})]})}}};