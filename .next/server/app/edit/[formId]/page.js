(()=>{var e={};e.id=2809,e.ids=[2809],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},95656:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.Z,__next_app__:()=>m,originalPathname:()=>c,pages:()=>d,routeModule:()=>x,tree:()=>n}),a(80699),a(68874),a(20784),a(35866);var t=a(23191),r=a(88716),l=a(87506),i=a(95231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(s,o);let n=["",{children:["edit",{children:["[formId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,80699)),"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/edit/[formId]/page.js"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,68874)),"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/layout.js"],error:[()=>Promise.resolve().then(a.bind(a,20784)),"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/error.js"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/edit/[formId]/page.js"],c="/edit/[formId]/page",m={require:a,loadChunk:()=>Promise.resolve()},x=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/edit/[formId]/page",pathname:"/edit/[formId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},86830:(e,s,a)=>{Promise.resolve().then(a.bind(a,30536))},30536:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var t=a(10326),r=a(17577),l=a(35047),i=a(86333);let o=(0,a(62881).Z)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var n=a(41291),d=a(85206),c=a(45480),m=a(98091),x=a(40381),u=a(79392),p=a(56813);function h(){let e=(0,l.useParams)(),s=(0,l.useRouter)(),[a,p]=(0,r.useState)(null),[h,b]=(0,r.useState)([]),[g,f]=(0,r.useState)(""),[j,y]=(0,r.useState)(""),[v,N]=(0,r.useState)(!0),[k,w]=(0,r.useState)(!1),[P,Z]=(0,r.useState)(!1),[_,q]=(0,r.useState)(null),S=(e,s,a)=>{b(h.map(t=>t.id===e?{...t,[s]:a}:t)),Z(!0)},C=e=>{confirm("Are you sure you want to delete this field? This cannot be undone.")&&(b(h.filter(s=>s.id!==e)),Z(!0),x.ZP.success("Field deleted"))},E=(e,s)=>{q(s),e.dataTransfer.effectAllowed="move"},F=e=>{e.preventDefault(),e.dataTransfer.dropEffect="move"},M=(e,s)=>{if(e.preventDefault(),null===_)return;let a=h[_],t=[...h];t.splice(_,1),t.splice(_<s?s-1:s,0,a),b(t.map((e,s)=>({...e,field_order:s}))),q(null),Z(!0),x.ZP.success("Field order updated")},G=()=>{q(null)},A=e=>{f(e),Z(!0)},H=e=>{y(e),Z(!0)},D=async()=>{w(!0);try{if(!(await fetch(`/api/aloa-forms/${e.formId}/edit-fields`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({fields:h,title:g,description:j})})).ok)throw Error("Failed to update form");x.ZP.success("Form updated successfully!"),Z(!1)}catch(e){console.error("Error updating form:",e),x.ZP.error("Failed to update form")}finally{w(!1)}};return v?t.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center",children:t.jsx(u.Z,{message:"Loading form editor..."})}):a?(0,t.jsxs)("div",{className:"min-h-screen bg-gradient-subtle",children:[t.jsx("div",{className:"bg-aloa-black text-aloa-white shadow-lg sticky top-0 z-10",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx("button",{onClick:()=>s.push("/dashboard"),className:"p-2 hover:bg-aloa-white/10 rounded-lg transition-colors",children:t.jsx(i.Z,{className:"w-5 h-5"})}),(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-xl font-display font-bold",children:"Edit Form"}),t.jsx("p",{className:"text-sm text-aloa-white/70",children:"Update form details and fields"})]})]}),(0,t.jsxs)("button",{onClick:D,disabled:!P||k,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-all ${P&&!k?"bg-aloa-white text-aloa-black hover:bg-opacity-90":"bg-aloa-white/20 text-aloa-white/50 cursor-not-allowed"}`,children:[t.jsx(o,{className:"w-4 h-4"}),k?"Saving...":"Save Changes"]})]})})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:(0,t.jsxs)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[t.jsx(n.Z,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm text-amber-800",children:[t.jsx("p",{className:"font-semibold mb-1",children:"Important: Be careful when deleting fields"}),t.jsx("p",{children:"Deleting fields will permanently remove them from the form. Field types cannot be changed as it may break existing responses."}),t.jsx("p",{className:"mt-1",children:"You can drag and drop fields to reorder them."})]})]})}),t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsx("div",{className:"bg-aloa-white rounded-lg shadow-md p-6 mb-6",children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[t.jsx(d.Z,{className:"w-5 h-5 text-aloa-black mt-2"}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-2",children:"Form Title"}),t.jsx("input",{type:"text",value:g,onChange:e=>A(e.target.value),className:"w-full px-4 py-2 border-2 border-aloa-sand rounded-lg focus:border-aloa-black focus:outline-none transition-colors text-lg font-medium",placeholder:"Enter form title..."})]})]}),(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[t.jsx(d.Z,{className:"w-5 h-5 text-aloa-black mt-2"}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-2",children:"Form Description"}),t.jsx("textarea",{value:j,onChange:e=>H(e.target.value),className:"w-full px-4 py-2 border-2 border-aloa-sand rounded-lg focus:border-aloa-black focus:outline-none transition-colors resize-none",rows:3,placeholder:"Enter the description that appears below the form title..."})]})]})]})})}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12",children:[t.jsx("h2",{className:"text-lg font-semibold text-aloa-black mb-4",children:"Form Fields"}),t.jsx("div",{className:"space-y-4",children:h.map((e,s)=>t.jsx("div",{className:`bg-aloa-white rounded-lg shadow-md p-6 transition-all cursor-move ${_===s?"opacity-50":""}`,draggable:!0,onDragStart:e=>E(e,s),onDragOver:F,onDrop:e=>M(e,s),onDragEnd:G,children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex-shrink-0 flex items-center gap-2",children:[t.jsx(c.Z,{className:"w-5 h-5 text-aloa-gray hover:text-aloa-black cursor-grab"}),t.jsx("div",{className:"w-10 h-10 bg-aloa-black text-aloa-white rounded-full flex items-center justify-center font-bold",children:s+1})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-1",children:"Question / Label"}),t.jsx("input",{type:"text",value:e.field_label||"",onChange:s=>S(e.id,"field_label",s.target.value),className:"w-full px-4 py-2 border-2 border-aloa-sand rounded-lg focus:border-aloa-black focus:outline-none transition-colors"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-1",children:"Field Type"}),t.jsx("div",{className:"px-4 py-2 bg-gray-100 border-2 border-gray-200 rounded-lg text-gray-600",children:e.field_type})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-1",children:"Field Name"}),t.jsx("div",{className:"px-4 py-2 bg-gray-100 border-2 border-gray-200 rounded-lg text-gray-600 font-mono text-sm",children:e.field_name})]})]}),["text","email","tel","url","number","textarea"].includes(e.field_type)&&(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-1",children:"Placeholder Text"}),t.jsx("input",{type:"text",value:e.placeholder||"",onChange:s=>S(e.id,"placeholder",s.target.value),className:"w-full px-4 py-2 border-2 border-aloa-sand rounded-lg focus:border-aloa-black focus:outline-none transition-colors",placeholder:"Enter placeholder text..."})]}),["select","radio","checkbox"].includes(e.field_type)&&e.options&&(0,t.jsxs)("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-aloa-gray mb-1",children:"Options"}),t.jsx("textarea",{value:e.options.join("\n"),onChange:s=>S(e.id,"options",s.target.value.split("\n").filter(e=>e.trim())),className:"w-full px-4 py-2 border-2 border-aloa-sand rounded-lg focus:border-aloa-black focus:outline-none transition-colors",rows:e.options.length+1,placeholder:"One option per line..."})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6 text-sm",children:[void 0!==e.required&&(0,t.jsxs)("label",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",checked:e.required,onChange:s=>S(e.id,"required",s.target.checked),className:"rounded border-aloa-sand text-aloa-black focus:ring-aloa-black"}),t.jsx("span",{className:"text-aloa-gray",children:"Required field"})]}),e.section&&(0,t.jsxs)("div",{className:"text-aloa-gray",children:["Section: ",t.jsx("span",{className:"font-medium text-aloa-black",children:e.section})]})]})]}),t.jsx("div",{className:"flex-shrink-0",children:t.jsx("button",{onClick:()=>C(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete field",children:t.jsx(m.Z,{className:"w-5 h-5"})})})]})},e.id))})]})]}):null}function b(){return t.jsx(p.Z,{requireAuth:!0,redirectTo:"/auth/login",children:t.jsx(h,{})})}},56813:(e,s,a)=>{"use strict";a.d(s,{Z:()=>n});var t=a(10326),r=a(17577),l=a(35047);a(66954);var i=a(9015),o=a(41291);function n({children:e,allowedRoles:s=[],redirectTo:a="/auth/login",requireAuth:n=!0}){let d=(0,l.useRouter)(),[c,m]=(0,r.useState)(!0),[x,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[b,g]=(0,r.useState)(null);return c?t.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[t.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Checking permissions..."})]})}):b||!x?t.jsx("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-xl max-w-md w-full",children:[t.jsx("div",{className:"flex justify-center mb-6",children:t.jsx("div",{className:"p-4 bg-red-100 rounded-full",children:t.jsx(i.Z,{className:"w-8 h-8 text-red-600"})})}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900 text-center mb-2",children:"Access Restricted"}),t.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,t.jsxs)("div",{className:"flex items-start",children:[t.jsx(o.Z,{className:"w-5 h-5 text-red-600 mt-0.5 mr-2 flex-shrink-0"}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"text-red-800 text-sm",children:b||"You do not have permission to access this page."}),p&&(0,t.jsxs)("p",{className:"text-red-600 text-xs mt-1",children:["Your role: ",t.jsx("span",{className:"font-semibold",children:p})]})]})]})}),(0,t.jsxs)("div",{className:"space-y-3",children:[t.jsx("button",{onClick:()=>d.back(),className:"w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:"Go Back"}),t.jsx("button",{onClick:()=>d.push("/dashboard"),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Dashboard"})]})]})}):e}},79392:(e,s,a)=>{"use strict";a.d(s,{Z:()=>l});var t=a(10326),r=a(55795);function l({message:e="Loading...",size:s="default"}){let a={small:"w-8 h-8",default:"w-16 h-16",large:"w-24 h-24"};return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[200px] p-8",children:[t.jsx(r.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3},className:"relative",children:(0,t.jsxs)("div",{className:`${a[s]} relative`,children:[t.jsx("div",{className:"absolute inset-0 bg-aloa-black rounded-full animate-ping opacity-20"}),t.jsx("div",{className:`${a[s]} bg-aloa-black rounded-full animate-pulse`})]})}),e&&t.jsx(r.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-4 text-sm font-display uppercase tracking-wider text-aloa-gray",children:e})]})}},66954:(e,s,a)=>{"use strict";a.d(s,{e:()=>l});var t=a(70474);let r=null;function l(){if(r)return r;let e="https://eycgzjqwowrdmjlzqqyg.supabase.co",s="sb_publishable_eG0lH_ACpyOjqG44mN_5PA_1-oFLr5n";if(console.log("Creating Supabase browser client with:",{url:e,keyPrefix:s?s.substring(0,20)+"...":"NO KEY"}),!e||!s)throw console.error("Missing Supabase environment variables"),Error("Supabase configuration is missing");return r=(0,t.createBrowserClient)(e,s)}},86333:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},41291:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},45480:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]])},85206:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]])},98091:(e,s,a)=>{"use strict";a.d(s,{Z:()=>t});let t=(0,a(62881).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},80699:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(68570).createProxy)(String.raw`/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/edit/[formId]/page.js#default`)}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[9276,5495,9375,6465],()=>a(95656));module.exports=t})();