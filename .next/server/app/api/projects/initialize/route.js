"use strict";(()=>{var e={};e.id=5017,e.ids=[5017],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},88284:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>y,patchFetch:()=>j,requestAsyncStorage:()=>u,routeModule:()=>m,serverHooks:()=>_,staticGenerationAsyncStorage:()=>d});var t={};r.r(t),r.d(t,{POST:()=>l});var n=r(49303),i=r(88716),a=r(60670),s=r(87070),p=r(76995);let c=[{name:"Contract & Project Setup",type:"milestone",sequence_order:1,unlock_condition:{type:"manual"}},{name:"Design Inspiration Survey",type:"form",sequence_order:2,form_type:"design_inspiration",unlock_condition:{type:"previous_complete"}},{name:"Mood Board Selection",type:"form",sequence_order:3,form_type:"mood_board_selection",unlock_condition:{type:"previous_complete"}},{name:"Font Selection",type:"form",sequence_order:4,form_type:"font_selection",unlock_condition:{type:"previous_complete"}},{name:"Color Palette Selection",type:"form",sequence_order:5,form_type:"color_palette",unlock_condition:{type:"previous_complete"}},{name:"Homepage Content Brief",type:"form",sequence_order:6,form_type:"homepage_content",unlock_condition:{type:"previous_complete"}},{name:"Homepage Copy Creation",type:"content",sequence_order:7,unlock_condition:{type:"previous_complete"}},{name:"Homepage Design",type:"design",sequence_order:8,unlock_condition:{type:"previous_complete"}},{name:"Site Structure Builder",type:"form",sequence_order:9,form_type:"sitemap_builder",unlock_condition:{type:"previous_complete"}},{name:"Design Review & Approval",type:"review",sequence_order:100,unlock_condition:{type:"all_pages_complete"}},{name:"Development Phase",type:"milestone",sequence_order:101,unlock_condition:{type:"design_approved"}},{name:"Final Review & Launch",type:"review",sequence_order:102,unlock_condition:{type:"development_complete"}}];async function l(e){try{let{projectName:o,clientName:r,clientEmail:t,contractSignedDate:n,startDate:i,estimatedCompletionDate:a,introductionVideoUrl:l,mainPages:m=5,auxPages:u=5}=await e.json();if(!o||!r||!t)return s.NextResponse.json({error:"Project name, client name, and client email are required"},{status:400});let{data:d,error:_}=await p.O.from("aloa_projects").insert([{project_name:o,client_name:r,client_email:t,contract_signed_date:n,start_date:i,estimated_completion_date:a,introduction_video_url:l,status:"initiated",rules:{main_pages:m,aux_pages:u}}]).select().single();if(_)return console.error("Error creating project:",_),s.NextResponse.json({error:"Failed to create project"},{status:500});let y=c.map((e,o)=>({project_id:d.id,name:e.name,type:e.type,sequence_order:e.sequence_order,status:0===o?"available":"locked",unlock_condition:e.unlock_condition,metadata:e.form_type?{form_type:e.form_type}:{}})),{error:j}=await p.O.from("aloa_projectlets").insert(y);j&&console.error("Error creating projectlets:",j);let{error:f}=await p.O.from("aloa_project_team").insert([{project_id:d.id,email:t,name:r,role:"client",permissions:{can_fill_forms:!0,can_approve:!0,can_edit_project:!1}}]);for(let e of(f&&console.error("Error adding team member:",f),[{email:"ross@aloa.co",name:"Ross",role:"admin"},{email:"eli@aloa.co",name:"Eli",role:"designer"},{email:"eduardo@aloa.co",name:"Eduardo",role:"developer"}]))await p.O.from("aloa_project_team").insert([{project_id:d.id,email:e.email,name:e.name,role:e.role,permissions:{can_fill_forms:!0,can_approve:!0,can_edit_project:!0}}]);return await p.O.from("aloa_project_timeline").insert([{project_id:d.id,event_type:"project_started",description:`Project "${o}" initiated for ${r}`,metadata:{client_email:t,estimated_completion:a}}]),s.NextResponse.json({success:!0,project:d,message:"Project initialized successfully"})}catch(e){return console.error("Error initializing project:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let m=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/projects/initialize/route",pathname:"/api/projects/initialize",filename:"route",bundlePath:"app/api/projects/initialize/route"},resolvedPagePath:"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/api/projects/initialize/route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:u,staticGenerationAsyncStorage:d,serverHooks:_}=m,y="/api/projects/initialize/route";function j(){return(0,a.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:d})}},76995:(e,o,r)=>{r.d(o,{O:()=>a});var t=r(69498);let n="https://eycgzjqwowrdmjlzqqyg.supabase.co",i="sb_publishable_eG0lH_ACpyOjqG44mN_5PA_1-oFLr5n",a=null;n&&i?a=(0,t.eI)(n,i):console.error("Warning: Supabase environment variables are missing")}};var o=require("../../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[9276,5972,9498],()=>r(88284));module.exports=t})();