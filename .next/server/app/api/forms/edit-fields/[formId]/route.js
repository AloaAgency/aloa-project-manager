"use strict";(()=>{var e={};e.id=6209,e.ids=[6209],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},95983:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>c,patchFetch:()=>x,requestAsyncStorage:()=>u,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>f});var o={};t.r(o),t.d(o,{PATCH:()=>n});var i=t(49303),s=t(88716),a=t(60670),d=t(87070),l=t(76995);async function n(e,{params:r}){try{let{fields:t,title:o,description:i}=await e.json(),{formId:s}=r;if(void 0!==o||void 0!==i){let e={updated_at:new Date().toISOString()};void 0!==o&&(e.title=o),void 0!==i&&(e.description=i);let{error:r}=await l.O.from("aloa_forms").update(e).eq("id",s);if(r)return console.error("Error updating form:",r),d.NextResponse.json({error:"Failed to update form"},{status:500})}let{data:a,error:n}=await l.O.from("aloa_form_fields").select("id").eq("form_id",s);if(n)return console.error("Error fetching existing fields:",n),d.NextResponse.json({error:"Failed to fetch existing fields"},{status:500});let p=t.map(e=>e.id),u=a.filter(e=>!p.includes(e.id));if(u.length>0){let{error:e}=await l.O.from("aloa_form_fields").delete().in("id",u.map(e=>e.id));if(e)return console.error("Error deleting fields:",e),d.NextResponse.json({error:"Failed to delete fields"},{status:500})}let f=t.map((e,r)=>{let t={field_label:e.field_label,placeholder:e.placeholder,options:e.options,required:e.required,field_order:r,id:e.id,form_id:e.form_id,field_name:e.field_name,field_type:e.field_type,section:e.section,min:e.min,max:e.max,pattern:e.pattern};return l.O.from("aloa_form_fields").update(t).eq("id",e.id).eq("form_id",s)}),m=(await Promise.all(f)).filter(e=>e.error);if(m.length>0)return console.error("Update errors:",m),d.NextResponse.json({error:"Failed to update some fields"},{status:500});return d.NextResponse.json({success:!0})}catch(e){return console.error("Error updating form fields:",e),d.NextResponse.json({error:"Failed to update form fields"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/forms/edit-fields/[formId]/route",pathname:"/api/forms/edit-fields/[formId]",filename:"route",bundlePath:"app/api/forms/edit-fields/[formId]/route"},resolvedPagePath:"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/api/forms/edit-fields/[formId]/route.js",nextConfigOutput:"",userland:o}),{requestAsyncStorage:u,staticGenerationAsyncStorage:f,serverHooks:m}=p,c="/api/forms/edit-fields/[formId]/route";function x(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:f})}},76995:(e,r,t)=>{t.d(r,{O:()=>a});var o=t(69498);let i="https://eycgzjqwowrdmjlzqqyg.supabase.co",s="sb_publishable_eG0lH_ACpyOjqG44mN_5PA_1-oFLr5n",a=null;i&&s?a=(0,o.eI)(i,s):console.error("Warning: Supabase environment variables are missing")}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[9276,5972,9498],()=>t(95983));module.exports=o})();