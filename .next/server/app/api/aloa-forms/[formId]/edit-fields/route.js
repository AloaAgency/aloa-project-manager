"use strict";(()=>{var e={};e.id=2817,e.ids=[2817],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},47191:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>_,patchFetch:()=>c,requestAsyncStorage:()=>p,routeModule:()=>f,serverHooks:()=>m,staticGenerationAsyncStorage:()=>u});var t={};o.r(t),o.d(t,{PATCH:()=>n});var a=o(49303),i=o(88716),l=o(60670),d=o(87070),s=o(76995);async function n(e,{params:r}){try{let{formId:o}=r,{fields:t,title:a,description:i}=await e.json(),{error:l}=await s.O.from("aloa_forms").update({title:a,description:i,updated_at:new Date().toISOString()}).eq("id",o);if(l)return console.error("Error updating form:",l),d.NextResponse.json({error:"Failed to update form"},{status:500});for(let e of t)if(e.id){let{error:r}=await s.O.from("aloa_form_fields").update({field_label:e.field_label,field_name:e.field_name,field_type:e.field_type,required:e.required,placeholder:e.placeholder,options:e.options,validation:e.validation,field_order:e.field_order,help_text:e.help_text,default_value:e.default_value}).eq("id",e.id);r&&console.error("Error updating field:",r)}else{let{error:r}=await s.O.from("aloa_form_fields").insert({aloa_form_id:o,field_label:e.field_label,field_name:e.field_name,field_type:e.field_type,required:e.required,placeholder:e.placeholder,options:e.options,validation:e.validation,field_order:e.field_order,help_text:e.help_text,default_value:e.default_value});r&&console.error("Error inserting field:",r)}let n=t.filter(e=>e.id).map(e=>e.id);if(n.length>0){let{error:e}=await s.O.from("aloa_form_fields").delete().eq("aloa_form_id",o).not("id","in",`(${n.join(",")})`);e&&console.error("Error deleting removed fields:",e)}else{let{error:e}=await s.O.from("aloa_form_fields").delete().eq("aloa_form_id",o);e&&console.error("Error deleting all fields:",e)}return d.NextResponse.json({success:!0})}catch(e){return console.error("Error in PATCH /api/aloa-forms/[formId]/edit-fields:",e),d.NextResponse.json({error:"Internal server error"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/aloa-forms/[formId]/edit-fields/route",pathname:"/api/aloa-forms/[formId]/edit-fields",filename:"route",bundlePath:"app/api/aloa-forms/[formId]/edit-fields/route"},resolvedPagePath:"/Users/rosspalmer/Ross GitHub Projects/aloa-web-design-project-manager/app/api/aloa-forms/[formId]/edit-fields/route.js",nextConfigOutput:"",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:m}=f,_="/api/aloa-forms/[formId]/edit-fields/route";function c(){return(0,l.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:u})}},76995:(e,r,o)=>{o.d(r,{O:()=>l});var t=o(69498);let a="https://eycgzjqwowrdmjlzqqyg.supabase.co",i="sb_publishable_eG0lH_ACpyOjqG44mN_5PA_1-oFLr5n",l=null;a&&i?l=(0,t.eI)(a,i):console.error("Warning: Supabase environment variables are missing")}};var r=require("../../../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[9276,5972,9498],()=>o(47191));module.exports=t})();