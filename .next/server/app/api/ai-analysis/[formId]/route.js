"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai-analysis/[formId]/route";
exports.ids = ["app/api/ai-analysis/[formId]/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&page=%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute.js&appDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&page=%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute.js&appDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_rosspalmer_Ross_GitHub_Projects_custom_forms_app_api_ai_analysis_formId_route_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ai-analysis/[formId]/route.js */ \"(rsc)/./app/api/ai-analysis/[formId]/route.js\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai-analysis/[formId]/route\",\n        pathname: \"/api/ai-analysis/[formId]\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai-analysis/[formId]/route\"\n    },\n    resolvedPagePath: \"/Users/rosspalmer/Ross GitHub Projects/custom-forms/app/api/ai-analysis/[formId]/route.js\",\n    nextConfigOutput,\n    userland: _Users_rosspalmer_Ross_GitHub_Projects_custom_forms_app_api_ai_analysis_formId_route_js__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ai-analysis/[formId]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhaS1hbmFseXNpcyUyRiU1QmZvcm1JZCU1RCUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWktYW5hbHlzaXMlMkYlNUJmb3JtSWQlNUQlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhaS1hbmFseXNpcyUyRiU1QmZvcm1JZCU1RCUyRnJvdXRlLmpzJmFwcERpcj0lMkZVc2VycyUyRnJvc3NwYWxtZXIlMkZSb3NzJTIwR2l0SHViJTIwUHJvamVjdHMlMkZjdXN0b20tZm9ybXMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGcm9zc3BhbG1lciUyRlJvc3MlMjBHaXRIdWIlMjBQcm9qZWN0cyUyRmN1c3RvbS1mb3JtcyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jdXN0b20tZm9ybXMvP2FmNzciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL3Jvc3NwYWxtZXIvUm9zcyBHaXRIdWIgUHJvamVjdHMvY3VzdG9tLWZvcm1zL2FwcC9hcGkvYWktYW5hbHlzaXMvW2Zvcm1JZF0vcm91dGUuanNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2FpLWFuYWx5c2lzL1tmb3JtSWRdL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWktYW5hbHlzaXMvW2Zvcm1JZF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2FpLWFuYWx5c2lzL1tmb3JtSWRdL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL3Jvc3NwYWxtZXIvUm9zcyBHaXRIdWIgUHJvamVjdHMvY3VzdG9tLWZvcm1zL2FwcC9hcGkvYWktYW5hbHlzaXMvW2Zvcm1JZF0vcm91dGUuanNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2FpLWFuYWx5c2lzL1tmb3JtSWRdL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&page=%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute.js&appDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ai-analysis/[formId]/route.js":
/*!***********************************************!*\
  !*** ./app/api/ai-analysis/[formId]/route.js ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase */ \"(rsc)/./lib/supabase.js\");\n/* harmony import */ var _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @anthropic-ai/sdk */ \"(rsc)/./node_modules/@anthropic-ai/sdk/index.mjs\");\n\n\n\nconst anthropic = new _anthropic_ai_sdk__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n    apiKey: process.env.ANTHROPIC_API_KEY\n});\n// GET endpoint to retrieve cached analysis\nasync function GET(request, { params }) {\n    try {\n        const { formId } = params;\n        // Check if we have a cached analysis\n        const { data: cachedAnalysis, error } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"ai_analyses\").select(\"*\").eq(\"form_id\", formId).order(\"created_at\", {\n            ascending: false\n        }).limit(1).single();\n        if (cachedAnalysis && !error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                analysis: cachedAnalysis.analysis\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            analysis: null\n        });\n    } catch (error) {\n        console.error(\"Error fetching cached analysis:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            analysis: null\n        });\n    }\n}\n// POST endpoint to generate new analysis\nasync function POST(request, { params }) {\n    try {\n        const { formId } = params;\n        // Fetch form and responses\n        const { data: form, error: formError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"forms\").select(`\n        *,\n        form_fields (*)\n      `).eq(\"id\", formId).single();\n        if (formError || !form) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Form not found\"\n            }, {\n                status: 404\n            });\n        }\n        const { data: responses, error: responsesError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"form_responses\").select(\"*\").eq(\"form_id\", formId);\n        if (responsesError || !responses || responses.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"No responses found\"\n            }, {\n                status: 404\n            });\n        }\n        // Prepare data for AI analysis\n        const formStructure = {\n            title: form.title,\n            description: form.description,\n            fields: form.form_fields.map((field)=>({\n                    label: field.field_label,\n                    type: field.field_type,\n                    name: field.field_name,\n                    options: field.options\n                }))\n        };\n        const responseData = responses.map((r)=>r.response_data);\n        // Create the prompt for Claude\n        const prompt = `You are an expert analyst tasked with analyzing survey/form responses to identify patterns, consensus, conflicts, and actionable insights.\n\nForm Title: ${formStructure.title}\nForm Description: ${formStructure.description || \"N/A\"}\nTotal Responses: ${responses.length}\n\nForm Structure:\n${JSON.stringify(formStructure.fields, null, 2)}\n\nResponse Data:\n${JSON.stringify(responseData, null, 2)}\n\nPlease analyze these responses and provide a comprehensive analysis in the following JSON format:\n\n{\n  \"executiveSummary\": \"A 2-3 sentence executive summary of the key findings\",\n  \"totalResponses\": ${responses.length},\n  \"consensusScore\": <0-100 percentage representing overall agreement level>,\n  \"confidence\": <0-100 percentage representing your confidence in the analysis>,\n  \"consensusAreas\": [\n    {\n      \"topic\": \"Brief topic name\",\n      \"description\": \"What respondents agree on\",\n      \"agreementPercentage\": <percentage who agree>\n    }\n  ],\n  \"conflictAreas\": [\n    {\n      \"topic\": \"Brief topic name\",\n      \"viewpoints\": [\n        {\n          \"percentage\": <percentage with this view>,\n          \"description\": \"Description of this viewpoint\"\n        }\n      ]\n    }\n  ],\n  \"recommendations\": [\n    {\n      \"title\": \"Brief recommendation title\",\n      \"description\": \"Detailed actionable recommendation\",\n      \"priority\": \"high|medium|low\"\n    }\n  ],\n  \"stakeholderMessage\": \"A professional message to stakeholders summarizing the consensus and recommended next steps (2-3 sentences)\"\n}\n\nImportant guidelines:\n1. Be specific and reference actual response data\n2. Identify both explicit agreements and implicit patterns\n3. For conflicts, clearly show the different viewpoints and their prevalence\n4. Recommendations should be actionable and based on the data\n5. The stakeholder message should be diplomatic and action-oriented\n6. Consider both quantitative data (ratings, selections) and qualitative data (text responses)\n7. Look for themes across different questions that might be related`;\n        // Call Claude API\n        const completion = await anthropic.messages.create({\n            model: \"claude-3-haiku-20240307\",\n            max_tokens: 4000,\n            temperature: 0.3,\n            messages: [\n                {\n                    role: \"user\",\n                    content: prompt\n                }\n            ]\n        });\n        // Parse the AI response\n        let analysis;\n        try {\n            // Extract JSON from the response\n            const responseText = completion.content[0].text;\n            const jsonMatch = responseText.match(/\\{[\\s\\S]*\\}/);\n            if (jsonMatch) {\n                analysis = JSON.parse(jsonMatch[0]);\n            } else {\n                throw new Error(\"Could not extract JSON from response\");\n            }\n        } catch (parseError) {\n            console.error(\"Error parsing AI response:\", parseError);\n            // Provide a fallback analysis\n            analysis = {\n                executiveSummary: \"Analysis is being processed. Please try again.\",\n                totalResponses: responses.length,\n                consensusScore: 0,\n                confidence: 0,\n                consensusAreas: [],\n                conflictAreas: [],\n                recommendations: [],\n                stakeholderMessage: \"Analysis in progress.\"\n            };\n        }\n        // Store the analysis in the database\n        const { error: insertError } = await _lib_supabase__WEBPACK_IMPORTED_MODULE_1__.supabase.from(\"ai_analyses\").insert({\n            form_id: formId,\n            analysis: analysis,\n            created_at: new Date().toISOString()\n        });\n        if (insertError) {\n            console.error(\"Error caching analysis:\", insertError);\n        // Continue even if caching fails\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(analysis);\n    } catch (error) {\n        console.error(\"Error generating AI analysis:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to generate analysis\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2FpLWFuYWx5c2lzL1tmb3JtSWRdL3JvdXRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQTJDO0FBQ0Q7QUFDQTtBQUUxQyxNQUFNRyxZQUFZLElBQUlELHlEQUFTQSxDQUFDO0lBQzlCRSxRQUFRQyxRQUFRQyxHQUFHLENBQUNDLGlCQUFpQjtBQUN2QztBQUVBLDJDQUEyQztBQUNwQyxlQUFlQyxJQUFJQyxPQUFPLEVBQUUsRUFBRUMsTUFBTSxFQUFFO0lBQzNDLElBQUk7UUFDRixNQUFNLEVBQUVDLE1BQU0sRUFBRSxHQUFHRDtRQUVuQixxQ0FBcUM7UUFDckMsTUFBTSxFQUFFRSxNQUFNQyxjQUFjLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1iLG1EQUFRQSxDQUNuRGMsSUFBSSxDQUFDLGVBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxFQUFFLENBQUMsV0FBV04sUUFDZE8sS0FBSyxDQUFDLGNBQWM7WUFBRUMsV0FBVztRQUFNLEdBQ3ZDQyxLQUFLLENBQUMsR0FDTkMsTUFBTTtRQUVULElBQUlSLGtCQUFrQixDQUFDQyxPQUFPO1lBQzVCLE9BQU9kLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUFDO2dCQUFFQyxVQUFVVixlQUFlVSxRQUFRO1lBQUM7UUFDL0Q7UUFFQSxPQUFPdkIscURBQVlBLENBQUNzQixJQUFJLENBQUM7WUFBRUMsVUFBVTtRQUFLO0lBQzVDLEVBQUUsT0FBT1QsT0FBTztRQUNkVSxRQUFRVixLQUFLLENBQUMsbUNBQW1DQTtRQUNqRCxPQUFPZCxxREFBWUEsQ0FBQ3NCLElBQUksQ0FBQztZQUFFQyxVQUFVO1FBQUs7SUFDNUM7QUFDRjtBQUVBLHlDQUF5QztBQUNsQyxlQUFlRSxLQUFLaEIsT0FBTyxFQUFFLEVBQUVDLE1BQU0sRUFBRTtJQUM1QyxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxNQUFNLEVBQUUsR0FBR0Q7UUFFbkIsMkJBQTJCO1FBQzNCLE1BQU0sRUFBRUUsTUFBTWMsSUFBSSxFQUFFWixPQUFPYSxTQUFT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MUNjLElBQUksQ0FBQyxlQUNMNkQsTUFBTSxDQUFDO1lBQ05DLFNBQVNsRTtZQUNUWSxVQUFVQTtZQUNWdUQsWUFBWSxJQUFJQyxPQUFPQyxXQUFXO1FBQ3BDO1FBRUYsSUFBSUwsYUFBYTtZQUNmbkQsUUFBUVYsS0FBSyxDQUFDLDJCQUEyQjZEO1FBQ3pDLGlDQUFpQztRQUNuQztRQUVBLE9BQU8zRSxxREFBWUEsQ0FBQ3NCLElBQUksQ0FBQ0M7SUFDM0IsRUFBRSxPQUFPVCxPQUFPO1FBQ2RVLFFBQVFWLEtBQUssQ0FBQyxpQ0FBaUNBO1FBQy9DLE9BQU9kLHFEQUFZQSxDQUFDc0IsSUFBSSxDQUN0QjtZQUFFUixPQUFPO1FBQThCLEdBQ3ZDO1lBQUVjLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY3VzdG9tLWZvcm1zLy4vYXBwL2FwaS9haS1hbmFseXNpcy9bZm9ybUlkXS9yb3V0ZS5qcz9kMDg3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IHN1cGFiYXNlIH0gZnJvbSAnQC9saWIvc3VwYWJhc2UnO1xuaW1wb3J0IEFudGhyb3BpYyBmcm9tICdAYW50aHJvcGljLWFpL3Nkayc7XG5cbmNvbnN0IGFudGhyb3BpYyA9IG5ldyBBbnRocm9waWMoe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52LkFOVEhST1BJQ19BUElfS0VZLFxufSk7XG5cbi8vIEdFVCBlbmRwb2ludCB0byByZXRyaWV2ZSBjYWNoZWQgYW5hbHlzaXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxdWVzdCwgeyBwYXJhbXMgfSkge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZm9ybUlkIH0gPSBwYXJhbXM7XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgd2UgaGF2ZSBhIGNhY2hlZCBhbmFseXNpc1xuICAgIGNvbnN0IHsgZGF0YTogY2FjaGVkQW5hbHlzaXMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FpX2FuYWx5c2VzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdmb3JtX2lkJywgZm9ybUlkKVxuICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAubGltaXQoMSlcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBcbiAgICBpZiAoY2FjaGVkQW5hbHlzaXMgJiYgIWVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBhbmFseXNpczogY2FjaGVkQW5hbHlzaXMuYW5hbHlzaXMgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGFuYWx5c2lzOiBudWxsIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIGNhY2hlZCBhbmFseXNpczonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgYW5hbHlzaXM6IG51bGwgfSk7XG4gIH1cbn1cblxuLy8gUE9TVCBlbmRwb2ludCB0byBnZW5lcmF0ZSBuZXcgYW5hbHlzaXNcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3QsIHsgcGFyYW1zIH0pIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGZvcm1JZCB9ID0gcGFyYW1zO1xuICAgIFxuICAgIC8vIEZldGNoIGZvcm0gYW5kIHJlc3BvbnNlc1xuICAgIGNvbnN0IHsgZGF0YTogZm9ybSwgZXJyb3I6IGZvcm1FcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdmb3JtcycpXG4gICAgICAuc2VsZWN0KGBcbiAgICAgICAgKixcbiAgICAgICAgZm9ybV9maWVsZHMgKCopXG4gICAgICBgKVxuICAgICAgLmVxKCdpZCcsIGZvcm1JZClcbiAgICAgIC5zaW5nbGUoKTtcbiAgICBcbiAgICBpZiAoZm9ybUVycm9yIHx8ICFmb3JtKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdGb3JtIG5vdCBmb3VuZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwNCB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB7IGRhdGE6IHJlc3BvbnNlcywgZXJyb3I6IHJlc3BvbnNlc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2Zvcm1fcmVzcG9uc2VzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCdmb3JtX2lkJywgZm9ybUlkKTtcbiAgICBcbiAgICBpZiAocmVzcG9uc2VzRXJyb3IgfHwgIXJlc3BvbnNlcyB8fCByZXNwb25zZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgZXJyb3I6ICdObyByZXNwb25zZXMgZm91bmQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDQgfVxuICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gUHJlcGFyZSBkYXRhIGZvciBBSSBhbmFseXNpc1xuICAgIGNvbnN0IGZvcm1TdHJ1Y3R1cmUgPSB7XG4gICAgICB0aXRsZTogZm9ybS50aXRsZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBmb3JtLmRlc2NyaXB0aW9uLFxuICAgICAgZmllbGRzOiBmb3JtLmZvcm1fZmllbGRzLm1hcChmaWVsZCA9PiAoe1xuICAgICAgICBsYWJlbDogZmllbGQuZmllbGRfbGFiZWwsXG4gICAgICAgIHR5cGU6IGZpZWxkLmZpZWxkX3R5cGUsXG4gICAgICAgIG5hbWU6IGZpZWxkLmZpZWxkX25hbWUsXG4gICAgICAgIG9wdGlvbnM6IGZpZWxkLm9wdGlvbnNcbiAgICAgIH0pKVxuICAgIH07XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2VzLm1hcChyID0+IHIucmVzcG9uc2VfZGF0YSk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIHRoZSBwcm9tcHQgZm9yIENsYXVkZVxuICAgIGNvbnN0IHByb21wdCA9IGBZb3UgYXJlIGFuIGV4cGVydCBhbmFseXN0IHRhc2tlZCB3aXRoIGFuYWx5emluZyBzdXJ2ZXkvZm9ybSByZXNwb25zZXMgdG8gaWRlbnRpZnkgcGF0dGVybnMsIGNvbnNlbnN1cywgY29uZmxpY3RzLCBhbmQgYWN0aW9uYWJsZSBpbnNpZ2h0cy5cblxuRm9ybSBUaXRsZTogJHtmb3JtU3RydWN0dXJlLnRpdGxlfVxuRm9ybSBEZXNjcmlwdGlvbjogJHtmb3JtU3RydWN0dXJlLmRlc2NyaXB0aW9uIHx8ICdOL0EnfVxuVG90YWwgUmVzcG9uc2VzOiAke3Jlc3BvbnNlcy5sZW5ndGh9XG5cbkZvcm0gU3RydWN0dXJlOlxuJHtKU09OLnN0cmluZ2lmeShmb3JtU3RydWN0dXJlLmZpZWxkcywgbnVsbCwgMil9XG5cblJlc3BvbnNlIERhdGE6XG4ke0pTT04uc3RyaW5naWZ5KHJlc3BvbnNlRGF0YSwgbnVsbCwgMil9XG5cblBsZWFzZSBhbmFseXplIHRoZXNlIHJlc3BvbnNlcyBhbmQgcHJvdmlkZSBhIGNvbXByZWhlbnNpdmUgYW5hbHlzaXMgaW4gdGhlIGZvbGxvd2luZyBKU09OIGZvcm1hdDpcblxue1xuICBcImV4ZWN1dGl2ZVN1bW1hcnlcIjogXCJBIDItMyBzZW50ZW5jZSBleGVjdXRpdmUgc3VtbWFyeSBvZiB0aGUga2V5IGZpbmRpbmdzXCIsXG4gIFwidG90YWxSZXNwb25zZXNcIjogJHtyZXNwb25zZXMubGVuZ3RofSxcbiAgXCJjb25zZW5zdXNTY29yZVwiOiA8MC0xMDAgcGVyY2VudGFnZSByZXByZXNlbnRpbmcgb3ZlcmFsbCBhZ3JlZW1lbnQgbGV2ZWw+LFxuICBcImNvbmZpZGVuY2VcIjogPDAtMTAwIHBlcmNlbnRhZ2UgcmVwcmVzZW50aW5nIHlvdXIgY29uZmlkZW5jZSBpbiB0aGUgYW5hbHlzaXM+LFxuICBcImNvbnNlbnN1c0FyZWFzXCI6IFtcbiAgICB7XG4gICAgICBcInRvcGljXCI6IFwiQnJpZWYgdG9waWMgbmFtZVwiLFxuICAgICAgXCJkZXNjcmlwdGlvblwiOiBcIldoYXQgcmVzcG9uZGVudHMgYWdyZWUgb25cIixcbiAgICAgIFwiYWdyZWVtZW50UGVyY2VudGFnZVwiOiA8cGVyY2VudGFnZSB3aG8gYWdyZWU+XG4gICAgfVxuICBdLFxuICBcImNvbmZsaWN0QXJlYXNcIjogW1xuICAgIHtcbiAgICAgIFwidG9waWNcIjogXCJCcmllZiB0b3BpYyBuYW1lXCIsXG4gICAgICBcInZpZXdwb2ludHNcIjogW1xuICAgICAgICB7XG4gICAgICAgICAgXCJwZXJjZW50YWdlXCI6IDxwZXJjZW50YWdlIHdpdGggdGhpcyB2aWV3PixcbiAgICAgICAgICBcImRlc2NyaXB0aW9uXCI6IFwiRGVzY3JpcHRpb24gb2YgdGhpcyB2aWV3cG9pbnRcIlxuICAgICAgICB9XG4gICAgICBdXG4gICAgfVxuICBdLFxuICBcInJlY29tbWVuZGF0aW9uc1wiOiBbXG4gICAge1xuICAgICAgXCJ0aXRsZVwiOiBcIkJyaWVmIHJlY29tbWVuZGF0aW9uIHRpdGxlXCIsXG4gICAgICBcImRlc2NyaXB0aW9uXCI6IFwiRGV0YWlsZWQgYWN0aW9uYWJsZSByZWNvbW1lbmRhdGlvblwiLFxuICAgICAgXCJwcmlvcml0eVwiOiBcImhpZ2h8bWVkaXVtfGxvd1wiXG4gICAgfVxuICBdLFxuICBcInN0YWtlaG9sZGVyTWVzc2FnZVwiOiBcIkEgcHJvZmVzc2lvbmFsIG1lc3NhZ2UgdG8gc3Rha2Vob2xkZXJzIHN1bW1hcml6aW5nIHRoZSBjb25zZW5zdXMgYW5kIHJlY29tbWVuZGVkIG5leHQgc3RlcHMgKDItMyBzZW50ZW5jZXMpXCJcbn1cblxuSW1wb3J0YW50IGd1aWRlbGluZXM6XG4xLiBCZSBzcGVjaWZpYyBhbmQgcmVmZXJlbmNlIGFjdHVhbCByZXNwb25zZSBkYXRhXG4yLiBJZGVudGlmeSBib3RoIGV4cGxpY2l0IGFncmVlbWVudHMgYW5kIGltcGxpY2l0IHBhdHRlcm5zXG4zLiBGb3IgY29uZmxpY3RzLCBjbGVhcmx5IHNob3cgdGhlIGRpZmZlcmVudCB2aWV3cG9pbnRzIGFuZCB0aGVpciBwcmV2YWxlbmNlXG40LiBSZWNvbW1lbmRhdGlvbnMgc2hvdWxkIGJlIGFjdGlvbmFibGUgYW5kIGJhc2VkIG9uIHRoZSBkYXRhXG41LiBUaGUgc3Rha2Vob2xkZXIgbWVzc2FnZSBzaG91bGQgYmUgZGlwbG9tYXRpYyBhbmQgYWN0aW9uLW9yaWVudGVkXG42LiBDb25zaWRlciBib3RoIHF1YW50aXRhdGl2ZSBkYXRhIChyYXRpbmdzLCBzZWxlY3Rpb25zKSBhbmQgcXVhbGl0YXRpdmUgZGF0YSAodGV4dCByZXNwb25zZXMpXG43LiBMb29rIGZvciB0aGVtZXMgYWNyb3NzIGRpZmZlcmVudCBxdWVzdGlvbnMgdGhhdCBtaWdodCBiZSByZWxhdGVkYDtcblxuICAgIC8vIENhbGwgQ2xhdWRlIEFQSVxuICAgIGNvbnN0IGNvbXBsZXRpb24gPSBhd2FpdCBhbnRocm9waWMubWVzc2FnZXMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAnY2xhdWRlLTMtaGFpa3UtMjAyNDAzMDcnLFxuICAgICAgbWF4X3Rva2VuczogNDAwMCxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjMsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgcm9sZTogJ3VzZXInLFxuICAgICAgICAgIGNvbnRlbnQ6IHByb21wdFxuICAgICAgICB9XG4gICAgICBdXG4gICAgfSk7XG4gICAgXG4gICAgLy8gUGFyc2UgdGhlIEFJIHJlc3BvbnNlXG4gICAgbGV0IGFuYWx5c2lzO1xuICAgIHRyeSB7XG4gICAgICAvLyBFeHRyYWN0IEpTT04gZnJvbSB0aGUgcmVzcG9uc2VcbiAgICAgIGNvbnN0IHJlc3BvbnNlVGV4dCA9IGNvbXBsZXRpb24uY29udGVudFswXS50ZXh0O1xuICAgICAgY29uc3QganNvbk1hdGNoID0gcmVzcG9uc2VUZXh0Lm1hdGNoKC9cXHtbXFxzXFxTXSpcXH0vKTtcbiAgICAgIGlmIChqc29uTWF0Y2gpIHtcbiAgICAgICAgYW5hbHlzaXMgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBleHRyYWN0IEpTT04gZnJvbSByZXNwb25zZScpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKHBhcnNlRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHBhcnNpbmcgQUkgcmVzcG9uc2U6JywgcGFyc2VFcnJvcik7XG4gICAgICAvLyBQcm92aWRlIGEgZmFsbGJhY2sgYW5hbHlzaXNcbiAgICAgIGFuYWx5c2lzID0ge1xuICAgICAgICBleGVjdXRpdmVTdW1tYXJ5OiBcIkFuYWx5c2lzIGlzIGJlaW5nIHByb2Nlc3NlZC4gUGxlYXNlIHRyeSBhZ2Fpbi5cIixcbiAgICAgICAgdG90YWxSZXNwb25zZXM6IHJlc3BvbnNlcy5sZW5ndGgsXG4gICAgICAgIGNvbnNlbnN1c1Njb3JlOiAwLFxuICAgICAgICBjb25maWRlbmNlOiAwLFxuICAgICAgICBjb25zZW5zdXNBcmVhczogW10sXG4gICAgICAgIGNvbmZsaWN0QXJlYXM6IFtdLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IFtdLFxuICAgICAgICBzdGFrZWhvbGRlck1lc3NhZ2U6IFwiQW5hbHlzaXMgaW4gcHJvZ3Jlc3MuXCJcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIC8vIFN0b3JlIHRoZSBhbmFseXNpcyBpbiB0aGUgZGF0YWJhc2VcbiAgICBjb25zdCB7IGVycm9yOiBpbnNlcnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhaV9hbmFseXNlcycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgZm9ybV9pZDogZm9ybUlkLFxuICAgICAgICBhbmFseXNpczogYW5hbHlzaXMsXG4gICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgICAgfSk7XG4gICAgXG4gICAgaWYgKGluc2VydEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjYWNoaW5nIGFuYWx5c2lzOicsIGluc2VydEVycm9yKTtcbiAgICAgIC8vIENvbnRpbnVlIGV2ZW4gaWYgY2FjaGluZyBmYWlsc1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oYW5hbHlzaXMpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdlbmVyYXRpbmcgQUkgYW5hbHlzaXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdGYWlsZWQgdG8gZ2VuZXJhdGUgYW5hbHlzaXMnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInN1cGFiYXNlIiwiQW50aHJvcGljIiwiYW50aHJvcGljIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkFOVEhST1BJQ19BUElfS0VZIiwiR0VUIiwicmVxdWVzdCIsInBhcmFtcyIsImZvcm1JZCIsImRhdGEiLCJjYWNoZWRBbmFseXNpcyIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsImVxIiwib3JkZXIiLCJhc2NlbmRpbmciLCJsaW1pdCIsInNpbmdsZSIsImpzb24iLCJhbmFseXNpcyIsImNvbnNvbGUiLCJQT1NUIiwiZm9ybSIsImZvcm1FcnJvciIsInN0YXR1cyIsInJlc3BvbnNlcyIsInJlc3BvbnNlc0Vycm9yIiwibGVuZ3RoIiwiZm9ybVN0cnVjdHVyZSIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJmaWVsZHMiLCJmb3JtX2ZpZWxkcyIsIm1hcCIsImZpZWxkIiwibGFiZWwiLCJmaWVsZF9sYWJlbCIsInR5cGUiLCJmaWVsZF90eXBlIiwibmFtZSIsImZpZWxkX25hbWUiLCJvcHRpb25zIiwicmVzcG9uc2VEYXRhIiwiciIsInJlc3BvbnNlX2RhdGEiLCJwcm9tcHQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29tcGxldGlvbiIsIm1lc3NhZ2VzIiwiY3JlYXRlIiwibW9kZWwiLCJtYXhfdG9rZW5zIiwidGVtcGVyYXR1cmUiLCJyb2xlIiwiY29udGVudCIsInJlc3BvbnNlVGV4dCIsInRleHQiLCJqc29uTWF0Y2giLCJtYXRjaCIsInBhcnNlIiwiRXJyb3IiLCJwYXJzZUVycm9yIiwiZXhlY3V0aXZlU3VtbWFyeSIsInRvdGFsUmVzcG9uc2VzIiwiY29uc2Vuc3VzU2NvcmUiLCJjb25maWRlbmNlIiwiY29uc2Vuc3VzQXJlYXMiLCJjb25mbGljdEFyZWFzIiwicmVjb21tZW5kYXRpb25zIiwic3Rha2Vob2xkZXJNZXNzYWdlIiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJmb3JtX2lkIiwiY3JlYXRlZF9hdCIsIkRhdGUiLCJ0b0lTT1N0cmluZyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ai-analysis/[formId]/route.js\n");

/***/ }),

/***/ "(rsc)/./lib/supabase.js":
/*!*************************!*\
  !*** ./lib/supabase.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://eycgzjqwowrdmjlzqqyg.supabase.co\" || 0;\nconst supabasePublishableKey = \"sb_publishable_eG0lH_ACpyOjqG44mN_5PA_1-oFLr5n\" || 0;\n// Only check for environment variables in production or when actually using the client\nlet supabase = null;\nif (supabaseUrl && supabasePublishableKey) {\n    supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabasePublishableKey);\n} else if (false) {}\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvc3VwYWJhc2UuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFFckQsTUFBTUMsY0FBY0MsMENBQW9DLElBQUk7QUFDNUQsTUFBTUcseUJBQXlCSCxnREFBZ0QsSUFBSTtBQUVuRix1RkFBdUY7QUFDdkYsSUFBSUssV0FBVztBQUVmLElBQUlOLGVBQWVJLHdCQUF3QjtJQUN6Q0UsV0FBV1AsbUVBQVlBLENBQUNDLGFBQWFJO0FBQ3ZDLE9BQU8sSUFBSUgsS0FBeUIsRUFBYyxFQUVqRDtBQUVtQiIsInNvdXJjZXMiOlsid2VicGFjazovL2N1c3RvbS1mb3Jtcy8uL2xpYi9zdXBhYmFzZS5qcz8xNTk4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIHx8ICcnO1xuY29uc3Qgc3VwYWJhc2VQdWJsaXNoYWJsZUtleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1BVQkxJU0hBQkxFX0tFWSB8fCAnJztcblxuLy8gT25seSBjaGVjayBmb3IgZW52aXJvbm1lbnQgdmFyaWFibGVzIGluIHByb2R1Y3Rpb24gb3Igd2hlbiBhY3R1YWxseSB1c2luZyB0aGUgY2xpZW50XG5sZXQgc3VwYWJhc2UgPSBudWxsO1xuXG5pZiAoc3VwYWJhc2VVcmwgJiYgc3VwYWJhc2VQdWJsaXNoYWJsZUtleSkge1xuICBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VQdWJsaXNoYWJsZUtleSk7XG59IGVsc2UgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcbiAgY29uc29sZS5lcnJvcignV2FybmluZzogU3VwYWJhc2UgZW52aXJvbm1lbnQgdmFyaWFibGVzIGFyZSBtaXNzaW5nJyk7XG59XG5cbmV4cG9ydCB7IHN1cGFiYXNlIH07Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlUHVibGlzaGFibGVLZXkiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9QVUJMSVNIQUJMRV9LRVkiLCJzdXBhYmFzZSIsImNvbnNvbGUiLCJlcnJvciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/supabase.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@supabase","vendor-chunks/@anthropic-ai"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&page=%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-analysis%2F%5BformId%5D%2Froute.js&appDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frosspalmer%2FRoss%20GitHub%20Projects%2Fcustom-forms&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();