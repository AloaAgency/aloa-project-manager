(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[881],{1138:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(5531).Z)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},2424:function(e,a,t){Promise.resolve().then(t.bind(t,2946))},2946:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return h}});var s=t(7437),n=t(2265),r=t(4033),i=t(5531);let l=(0,i.Z)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);var o=t(1138);let c=(0,i.Z)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),d=(0,i.Z)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);var m=t(2187),u=t(2462),p=t(5925);function h(){let e=(0,r.useParams)(),a=(0,r.useRouter)(),[t,i]=(0,n.useState)(null),[h,x]=(0,n.useState)([]),[f,y]=(0,n.useState)(!0),[b,j]=(0,n.useState)(null);(0,n.useEffect)(()=>{g()},[e.formId]);let g=async()=>{try{let[a,t]=await Promise.all([fetch("/api/forms/by-id/".concat(e.formId)),fetch("/api/responses?formId=".concat(e.formId))]);if(!a.ok||!t.ok)throw Error("Failed to fetch data");let s=await a.json(),n=await t.json();i(s),x(n)}catch(e){console.error("Error fetching data:",e),p.default.error("Failed to load responses"),a.push("/dashboard")}finally{y(!1)}},v=async e=>{if(confirm("Are you sure you want to delete this response? This action cannot be undone."))try{if(!(await fetch("/api/responses/".concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete response");p.default.success("Response deleted successfully"),x(h.filter(a=>a._id!==e))}catch(e){console.error("Error deleting response:",e),p.default.error("Failed to delete response")}},k=e=>new Date(e).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),N=e=>{j(b===e?null:e)};return f?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-subtle flex items-center justify-center",children:(0,s.jsx)(u.Z,{message:"Loading responses..."})}):t?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-subtle",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"mb-4 text-aloa-black hover:text-aloa-gray transition-colors font-display uppercase tracking-wider text-sm",children:"â† Back to Dashboard"}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl sm:text-3xl font-display font-bold text-aloa-black uppercase tracking-tight mb-2",children:t.title}),(0,s.jsx)("p",{className:"text-sm font-display uppercase tracking-wider",children:(0,s.jsxs)("span",{className:"bg-aloa-sand px-3 py-1 text-aloa-black inline-block",children:[h.length," response",1!==h.length?"s":""]})})]}),h.length>0&&(0,s.jsxs)("button",{onClick:()=>{if(!t||0===h.length){p.default.error("No data to export");return}let e=e=>{if(null==e)return"";let a=String(e);return a.includes(",")||a.includes('"')||a.includes("\n")?'"'.concat(a.replace(/"/g,'""'),'"'):a},a=[["Submitted At",...t.fields.map(e=>e.label)].map(e).join(","),...h.map(a=>[k(a.submittedAt),...t.fields.map(e=>{let t=a.data instanceof Map?a.data.get(e.name):a.data[e.name]||"";return Array.isArray(t)?t.join("; "):t})].map(e).join(","))].join("\n"),s=new Blob([a],{type:"text/csv"}),n=URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download="".concat(t.title.toLowerCase().replace(/\s+/g,"-"),"-responses.csv"),r.click(),URL.revokeObjectURL(n),p.default.success("Exported to CSV")},className:"btn-secondary flex items-center justify-center",children:[(0,s.jsx)(l,{className:"w-5 h-5 mr-2"}),"Export CSV"]})]})]}),0===h.length?(0,s.jsxs)("div",{className:"card text-center py-16",children:[(0,s.jsx)("p",{className:"text-xl text-aloa-gray mb-8 font-body",children:"No responses yet"}),(0,s.jsx)("button",{onClick:()=>window.open("/forms/".concat(t.urlId),"_blank"),className:"btn-primary mx-auto",children:"View Form"})]}):(0,s.jsx)("div",{className:"space-y-3 sm:space-y-4",children:h.map(e=>(0,s.jsxs)("div",{className:"card hover:shadow-xl transition-all duration-300",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex-1 cursor-pointer",onClick:()=>N(e._id),children:(0,s.jsxs)("p",{className:"text-sm font-display uppercase tracking-wider text-aloa-black",children:["Submitted ",k(e.submittedAt)]})}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{onClick:()=>v(e._id),className:"p-2 hover:bg-red-100 text-red-600 hover:text-red-700 transition-all duration-200",title:"Delete Response",children:(0,s.jsx)(o.Z,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:()=>N(e._id),className:"p-2 hover:bg-aloa-sand transition-all duration-200",children:b===e._id?(0,s.jsx)(c,{className:"w-5 h-5 transition-transform"}):(0,s.jsx)(d,{className:"w-5 h-5 transition-transform"})})]})]}),b===e._id&&(0,s.jsx)(m.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-6 pt-6 border-t-2 border-aloa-sand",children:(0,s.jsx)("div",{className:"grid gap-4 sm:grid-cols-2",children:t.fields.map(a=>{let t=e.data instanceof Map?e.data.get(a.name):e.data[a.name];return!t||Array.isArray(t)&&0===t.length?null:(0,s.jsxs)("div",{className:"bg-aloa-sand p-3",children:[(0,s.jsx)("p",{className:"text-xs font-display uppercase tracking-wider text-aloa-gray mb-1",children:a.label}),(0,s.jsx)("p",{className:"text-aloa-black font-body break-words",children:Array.isArray(t)?t.join(", "):t})]},a._id||a.id)})})})]},e._id))})]})}):null}},2462:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});var s=t(7437),n=t(2187);function r(e){let{message:a="Loading...",size:t="default"}=e,r={small:"w-8 h-8",default:"w-16 h-16",large:"w-24 h-24"};return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[200px] p-8",children:[(0,s.jsx)(n.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.3},className:"relative",children:(0,s.jsxs)("div",{className:"".concat(r[t]," relative"),children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-aloa-black rounded-full animate-ping opacity-20"}),(0,s.jsx)("div",{className:"".concat(r[t]," bg-aloa-black rounded-full animate-pulse")})]})}),a&&(0,s.jsx)(n.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-4 text-sm font-display uppercase tracking-wider text-aloa-gray",children:a})]})}}},function(e){e.O(0,[293,971,938,744],function(){return e(e.s=2424)}),_N_E=e.O()}]);