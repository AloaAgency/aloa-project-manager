"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[202,78,340],{78:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var s=r(7437),a=r(2265),o=r(2222),l=r(7168),n=r(2369),i=r(1817),c=r(4743),d=r(2883),m=r(1671),h=r(8867);function p(e){let t,{onMarkdownGenerated:r,projectContext:p,projectName:f}=e,[u,x]=(0,a.useState)([{role:"assistant",content:(t="Hi! I'm your AI form builder assistant.",f&&(t+=" I'm here to help you create a form for \"".concat(f,'".')),p&&(t+=" I have access to the project's context and knowledge base, so I can create forms that are specifically tailored to your project needs."),t+="\n\nDescribe the form you'd like to create, and I'll generate it for you. You can ask me to:\n\n• Create forms for specific purposes (e.g., 'Create a job application form')\n• Add or modify fields (e.g., 'Add a rating field for customer satisfaction')\n• Organize sections (e.g., 'Group contact info in one section')\n• Refine the form until it's perfect!\n\nWhat kind of form would you like to create?"),timestamp:new Date}]),[y,g]=(0,a.useState)(""),[b,j]=(0,a.useState)(!1),[w,v]=(0,a.useState)(""),[N,k]=(0,a.useState)(!1),Z=(0,a.useRef)(null),C=(0,a.useRef)(null),M=()=>{var e;null===(e=Z.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,a.useEffect)(()=>{M()},[u]);let S=async e=>{if(e.preventDefault(),!y.trim()||b)return;let t={role:"user",content:y.trim(),timestamp:new Date};x(e=>[...e,t]),g(""),j(!0);try{let e=await fetch("/api/ai-form-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...u,t],currentMarkdown:w,projectContext:p,projectName:f})});if(!e.ok)throw Error("Failed to get AI response");let r=await e.json();x(e=>[...e,{role:"assistant",content:r.message,timestamp:new Date}]),r.markdown&&v(r.markdown)}catch(e){console.error("Chat error:",e),x(e=>[...e,{role:"assistant",content:"Sorry, I encountered an error. Please try again.",timestamp:new Date,isError:!0}])}finally{j(!1)}};return(0,s.jsxs)("div",{className:"flex gap-6 h-[600px]",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col bg-white rounded-xl shadow-sm border",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b flex items-center justify-between bg-gradient-to-r from-purple-50 to-indigo-50",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 bg-white rounded-lg shadow-sm",children:(0,s.jsx)(o.Z,{className:"h-5 w-5 text-purple-600"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"AI Form Builder"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:"Chat to create your perfect form"})]})]}),(0,s.jsxs)("button",{onClick:()=>{x([{role:"assistant",content:"Hi! I'm your AI form builder assistant. Describe the form you'd like to create, and I'll generate it for you.",timestamp:new Date}]),v("")},className:"text-sm text-gray-500 hover:text-gray-700 flex items-center gap-1",children:[(0,s.jsx)(l.Z,{className:"h-4 w-4"}),"Reset"]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[u.map((e,t)=>(0,s.jsxs)("div",{className:"flex gap-3 ".concat("user"===e.role?"flex-row-reverse":""),children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-8 w-8 rounded-full flex items-center justify-center ".concat("user"===e.role?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-600"),children:"user"===e.role?(0,s.jsx)(n.Z,{className:"h-4 w-4"}):(0,s.jsx)(o.Z,{className:"h-4 w-4"})}),(0,s.jsxs)("div",{className:"flex-1 ".concat("user"===e.role?"text-right":""),children:[(0,s.jsx)("div",{className:"inline-block px-4 py-2 rounded-2xl max-w-[80%] ".concat("user"===e.role?"bg-purple-600 text-white":e.isError?"bg-red-50 text-red-900 border border-red-200":"bg-gray-100 text-gray-900"),children:(0,s.jsx)("p",{className:"whitespace-pre-wrap text-sm",children:e.content})}),(0,s.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},t)),b&&(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center",children:(0,s.jsx)(o.Z,{className:"h-4 w-4 text-gray-600"})}),(0,s.jsx)("div",{className:"bg-gray-100 rounded-2xl px-4 py-3",children:(0,s.jsx)(i.Z,{className:"h-4 w-4 animate-spin text-gray-600"})})]}),(0,s.jsx)("div",{ref:Z})]}),(0,s.jsx)("form",{onSubmit:S,className:"p-4 border-t bg-gray-50",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("textarea",{ref:C,value:y,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),S(e))},placeholder:"Describe your form or ask for changes...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none",rows:"2",disabled:b}),(0,s.jsx)("button",{type:"submit",disabled:!y.trim()||b,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:(0,s.jsx)(c.Z,{className:"h-5 w-5"})})]})})]}),(0,s.jsxs)("div",{className:"w-96 flex flex-col bg-white rounded-xl shadow-sm border",children:[(0,s.jsxs)("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-indigo-50 to-purple-50",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:"Generated Form"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:w?"Your form is ready!":"Form will appear here"})]}),(0,s.jsx)("div",{className:"flex-1 p-4 overflow-y-auto",children:w?(0,s.jsx)("pre",{className:"text-xs font-mono bg-gray-50 p-4 rounded-lg overflow-x-auto",children:w}):(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-gray-400",children:[(0,s.jsx)(d.Z,{className:"h-12 w-12 mb-3"}),(0,s.jsxs)("p",{className:"text-sm text-center",children:["Start chatting to generate",(0,s.jsx)("br",{}),"your custom form"]})]})}),w&&(0,s.jsxs)("div",{className:"p-4 border-t bg-gray-50 space-y-2",children:[(0,s.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(w),k(!0),setTimeout(()=>k(!1),2e3)},className:"w-full px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.Z,{className:"h-4 w-4 text-green-600"}),"Copied!"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{className:"h-4 w-4"}),"Copy Markdown"]})}),(0,s.jsxs)("button",{onClick:()=>{r&&w&&r(w)},className:"w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center gap-2",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4"}),"Generate Form"]})]})]})]})}},6202:function(e,t,r){r.r(t),r.d(t,{default:function(){return c}});var s=r(7437),a=r(2265),o=r(4972),l=r(2489),n=r(78),i=r(9064);function c(e){let{isOpen:t,onClose:r,projectId:c,projectName:d,projectKnowledge:m,projectletId:h,projectletName:p,onFormCreated:f}=e,[u,x]=(0,a.useState)(!1);if(!t)return null;let y=async e=>{x(!0);try{let t=e.split("\n"),s=t.find(e=>e.startsWith("#")),a=s?s.replace(/^#+\s*/,""):"Untitled Form",o=t.find(e=>e.trim()&&!e.startsWith("#")&&!e.startsWith("##")),l=await fetch("/api/aloa-forms",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:a,description:o||"",markdownContent:e,projectId:c,fields:g(e)})}),n=await l.json();if(!l.ok)throw Error(n.error||"Failed to create form");if(h&&n.id)try{if((await fetch("/api/aloa-projects/".concat(c,"/projectlets/").concat(h,"/applets"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.title||"Form",description:"Form created with AI: ".concat(n.title),type:"form",form_id:n.id,config:{formTitle:n.title,formId:n.id}})})).ok){i.ZP.success("Form created and attached to projectlet!"),f&&f(n),r();return}}catch(e){console.error("Error attaching form to projectlet:",e)}i.ZP.success("Form created successfully!"),f&&f(n),r()}catch(e){console.error("Form creation error:",e),i.ZP.error(e.message||"Failed to create form")}finally{x(!1)}},g=e=>{let t=[],r=e.split("\n"),s="General Information",a=0;for(let e=0;e<r.length;e++){let o=r[e];if(o.startsWith("## Section:")){s=o.replace("## Section:","").trim();continue}if(o.startsWith("- ")){let l=o.substring(2).split("|").map(e=>e.trim());if(l.length>=3){let o=l[0],n=o.includes("*"),i=o.replace("*","").trim().toLowerCase(),c={type:i,required:n,name:l[1],label:l[2],placeholder:l.length>=4?l[3]:"",section:s,position:a++};if(["select","radio","checkbox","multiselect"].includes(i)){let t=[],s=e+1;for(;s<r.length&&r[s].startsWith("  - ");)t.push(r[s].replace(/^\s+-\s*/,"").trim()),s++;t.length>0&&(c.options=t),e=s-1}t.push(c)}}}return t};return(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,s.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"text-2xl font-bold flex items-center",children:[(0,s.jsx)(o.Z,{className:"w-6 h-6 mr-2"}),"Create Form with AI"]}),(0,s.jsx)("p",{className:"text-purple-100 mt-1",children:p?'Creating form for "'.concat(p,'" in ').concat(d):"Creating form for ".concat(d)})]}),(0,s.jsx)("button",{onClick:r,className:"p-2 hover:bg-white/20 rounded-lg transition-colors",disabled:u,children:(0,s.jsx)(l.Z,{className:"w-6 h-6"})})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:u?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Creating your form..."})]}):(0,s.jsx)("div",{className:"h-full",children:(0,s.jsx)(n.default,{onMarkdownGenerated:y,projectKnowledge:m,embedded:!0,projectName:d,projectletName:p})})})]})})}},2222:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},1817:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7168:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4743:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},2369:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2883:function(e,t,r){r.d(t,{Z:function(){return s}});let s=(0,r(9205).Z)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]])}}]);