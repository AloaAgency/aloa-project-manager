"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{9986:function(e,s,t){t.r(s),t.d(s,{default:function(){return P}});var l=t(7437),a=t(2265),r=t(9376),i=t(166),n=t(8736),o=t(2208),c=t(7689),d=t(1671),m=t(2805);let p=(0,t(9205).Z)("gamepad-2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);var x=t(3417),u=t(8335),h=t(9397),g=t(1905),b=t(6362),f=t(8893),j=t(464),v=t(2489),y=t(2135),N=t(875),w=t(5868),k=t(8930),_=t(2222),C=t(9064);let Z=(0,i.default)(()=>t.e(340).then(t.bind(t,78)),{loadableGenerated:{webpack:()=>[78]},ssr:!1,loading:()=>(0,l.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"})})}),F={form:n.Z,review:o.Z,upload:c.Z,signoff:d.Z,moodboard:m.Z,sitemap_builder:p,content_gather:x.Z,feedback_loop:x.Z,link_submission:u.Z},S={form:"bg-blue-100 text-blue-700 border-blue-300",review:"bg-purple-100 text-purple-700 border-purple-300",upload:"bg-green-100 text-green-700 border-green-300",signoff:"bg-red-100 text-red-700 border-red-300",moodboard:"bg-pink-100 text-pink-700 border-pink-300",sitemap_builder:"bg-indigo-100 text-indigo-700 border-indigo-300",content_gather:"bg-yellow-100 text-yellow-700 border-yellow-300",feedback_loop:"bg-orange-100 text-orange-700 border-orange-300",link_submission:"bg-cyan-100 text-cyan-700 border-cyan-300"};function P(e){var s;let{projectId:t,projectletId:i,projectletName:c,availableForms:m=[],startWithLibraryOpen:p=!1,onAppletsUpdated:x}=e,P=(0,r.useRouter)(),[A,E]=(0,a.useState)([]),[I,T]=(0,a.useState)([]),[q,L]=(0,a.useState)(!0),[D,O]=(0,a.useState)(p),[M,R]=(0,a.useState)(null),[U,V]=(0,a.useState)(null),[z,B]=(0,a.useState)(null),[J,G]=(0,a.useState)(!1),[H,W]=(0,a.useState)("select"),[Y,K]=(0,a.useState)(null),[Q,X]=(0,a.useState)(!1),[$,ee]=(0,a.useState)(!1),[es,et]=(0,a.useState)(null);(0,a.useEffect)(()=>{el(),ea()},[i]);let el=async()=>{try{let e=await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets")),s=await e.json();console.log("Fetched applets:",s.applets),E(s.applets||[])}catch(e){console.error("Error fetching applets:",e)}finally{L(!1)}},ea=async()=>{try{let e=await fetch("/api/aloa-applets/library?active=true"),s=await e.json();T(s.applets||[])}catch(e){console.error("Error fetching library applets:",e)}},er=async e=>{try{console.log("Adding applet from library:",e);let n={library_applet_id:e.id,name:e.name,description:e.description,type:e.type,config:e.default_config||{},requires_approval:e.requires_approval,client_instructions:e.client_instructions};if("form"===e.type&&(n.config={form_id:null,required:!0},n.form_id=null),"link_submission"===e.type){var s,l,a,r;n.config={heading:(null===(s=e.default_config)||void 0===s?void 0:s.heading)||"Project Deliverables",description:(null===(l=e.default_config)||void 0===l?void 0:l.description)||"Please review the following materials:",links:(null===(a=e.default_config)||void 0===a?void 0:a.links)||[{text:"View Link",url:"https://example.com",description:"Link description"}],allow_client_acknowledgment:(null===(r=e.default_config)||void 0===r?void 0:r.allow_client_acknowledgment)!==!1}}console.log("Sending applet data to API:",n);let o=await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(o.ok){let e=await o.json();console.log("Created applet response:",e),C.ZP.success("Applet added successfully"),el(),O(!1),R(null),x&&x()}}catch(e){console.error("Error adding applet:",e),C.ZP.error("Failed to add applet")}},ei=async()=>{X(!0);try{let e=await fetch("/api/aloa-projects/".concat(t,"/knowledge")),s=await e.json();et(s),G(!1),ee(!0)}catch(e){console.error("Error loading project knowledge:",e),G(!1),ee(!0)}finally{X(!1)}},en=async e=>{try{let s=new Blob([e],{type:"text/markdown"}),l=new File([s],"ai-generated-form.md",{type:"text/markdown"}),a=new FormData;a.append("markdown",l),a.append("projectId",t);let r=await fetch("/api/aloa-forms/upload",{method:"POST",body:a}),n=await r.json();if(!r.ok)throw Error(n.error||"Failed to create form");n.id&&M&&(await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({library_applet_id:M.id,name:n.title||"AI Generated Form",description:M.description,type:"form",form_id:n.id,config:{formTitle:n.title,formId:n.id},requires_approval:M.requires_approval,client_instructions:M.client_instructions})})).ok&&(C.ZP.success("Form created and attached to projectlet!"),el()),ee(!1),R(null)}catch(e){console.error("Form creation error:",e),C.ZP.error(e.message||"Failed to create form")}},eo=async()=>{if(!Y){C.ZP.error("Please select a form");return}try{(await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({library_applet_id:null==M?void 0:M.id,name:(null==M?void 0:M.name)||"Form",description:(null==M?void 0:M.description)||"Form submission",type:"form",form_id:Y,config:{form_id:Y},requires_approval:!1,client_instructions:"Please complete this form"})})).ok&&(await el(),G(!1),K(null),W("select"),C.ZP.success("Form attached successfully"))}catch(e){console.error("Error attaching form:",e),C.ZP.error("Failed to attach form")}},ec=async(e,s)=>{try{(await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets"),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({appletId:e,...s})})).ok&&(C.ZP.success("Applet updated"),el(),B(null))}catch(e){console.error("Error updating applet:",e),C.ZP.error("Failed to update applet")}},ed=async(e,s)=>{try{(await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({appletId:e,status:s})})).ok&&(C.ZP.success("Status updated"),el())}catch(e){console.error("Error updating applet status:",e),C.ZP.error("Failed to update status")}},em=async e=>{if(confirm("Are you sure you want to delete this applet?"))try{(await fetch("/api/aloa-projects/".concat(t,"/projectlets/").concat(i,"/applets?appletId=").concat(e),{method:"DELETE"})).ok&&(C.ZP.success("Applet deleted"),el())}catch(e){console.error("Error deleting applet:",e),C.ZP.error("Failed to delete applet")}},ep=e=>({pending:"bg-gray-100 text-gray-600",active:"bg-blue-100 text-blue-700",in_progress:"bg-yellow-100 text-yellow-700",awaiting_review:"bg-purple-100 text-purple-700",revision_requested:"bg-orange-100 text-orange-700",approved:"bg-green-100 text-green-700",completed:"bg-green-100 text-green-700",skipped:"bg-gray-100 text-gray-500"})[e]||"bg-gray-100 text-gray-600";return q?(0,l.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,l.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-black"})}):p&&D?(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Choose an Applet to Add"}),(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:I.map(e=>{let s=F[e.type]||n.Z,t=S[e.type];return(0,l.jsx)("button",{onClick:()=>er(e),className:"p-4 rounded-lg border-2 ".concat(t," hover:opacity-80 transition-opacity text-left"),children:(0,l.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,l.jsx)(s,{className:"w-6 h-6 flex-shrink-0 mt-1"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h4",{className:"font-bold",children:e.name}),e.description&&(0,l.jsx)("p",{className:"text-sm opacity-75 mt-1",children:e.description})]})]})},e.id)})})]}):(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,l.jsxs)("h3",{className:"text-lg font-bold",children:["Applets in ",c]}),(0,l.jsxs)("button",{onClick:()=>O(!0),className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800 flex items-center",children:[(0,l.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Add Applet"]})]}),(0,l.jsx)("div",{className:"space-y-3",children:0===A.length?(0,l.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[(0,l.jsx)("p",{className:"text-gray-500",children:"No applets added yet"}),(0,l.jsx)("button",{onClick:()=>O(!0),className:"mt-4 text-black hover:underline",children:"Add your first applet"})]}):A.map((e,s)=>{var t,a,r,i,o,c,p;console.log("Rendering applet ".concat(s,":"),e.name,"Type:",e.type);let x=F[e.type]||n.Z,h=S[e.type]||"bg-gray-100 text-gray-700",_=U===e.id,C=z===e.id;return(0,l.jsx)("div",{className:"border-2 rounded-lg p-4 ".concat(h),children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex items-start flex-1",children:[(0,l.jsx)("div",{className:"mr-3 mt-1",children:(0,l.jsx)(g.Z,{className:"w-5 h-5 text-gray-400"})}),(0,l.jsx)(x,{className:"w-5 h-5 mr-3 mt-1"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsxs)("span",{className:"text-xs font-medium text-gray-500 mr-2",children:["#",s+1]}),C?(0,l.jsx)("input",{type:"text",value:e.name,onChange:e=>{let t=[...A];t[s].name=e.target.value,E(t)},className:"font-bold bg-white px-2 py-1 rounded"}):(0,l.jsx)("h4",{className:"font-bold",children:e.name})]}),e.description&&(0,l.jsx)("p",{className:"text-sm opacity-75 mt-1",children:e.description}),(0,l.jsxs)("div",{className:"flex items-center space-x-2 mt-3",children:[(0,l.jsxs)("select",{value:e.status,onChange:s=>ed(e.id,s.target.value),className:"px-2 py-1 rounded text-xs ".concat(ep(e.status)),children:[(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,l.jsx)("option",{value:"awaiting_review",children:"Awaiting Review"}),(0,l.jsx)("option",{value:"revision_requested",children:"Revision Requested"}),(0,l.jsx)("option",{value:"approved",children:"Approved"}),(0,l.jsx)("option",{value:"completed",children:"Completed"}),(0,l.jsx)("option",{value:"skipped",children:"Skipped"})]}),e.completion_percentage>0&&(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:(0,l.jsx)("div",{className:"bg-green-600 h-2 rounded-full",style:{width:"".concat(e.completion_percentage,"%")}})}),(0,l.jsxs)("span",{className:"text-xs ml-2",children:[e.completion_percentage,"%"]})]}),e.user_progress_summary&&e.user_progress_summary.total_users>0&&(0,l.jsx)("div",{className:"flex items-center space-x-2 ml-4",children:(0,l.jsxs)("div",{className:"flex items-center text-xs",children:[e.user_progress_summary.completed_count>0&&(0,l.jsxs)("span",{className:"px-2 py-1 bg-green-100 text-green-700 rounded",children:["✓ ",e.user_progress_summary.completed_count," completed"]}),e.user_progress_summary.in_progress_count>0&&(0,l.jsxs)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded ml-1",children:["⏳ ",e.user_progress_summary.in_progress_count," in progress"]})]})})]}),"form"===e.type&&(0,l.jsx)("div",{className:"mt-2 text-sm",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"font-medium",children:"Form:"}),(0,l.jsxs)("select",{value:e.form_id||"",onChange:s=>{"create_new"===s.target.value?(R(e),ee(!0)):s.target.value&&(console.log("Updating applet form_id:",e.id,"to:",s.target.value),ec(e.id,{form_id:s.target.value,config:{...e.config,form_id:s.target.value}}))},className:"px-2 py-1 bg-white border rounded text-sm flex-1 max-w-xs",children:[(0,l.jsx)("option",{value:"",children:"Select a form..."}),(0,l.jsx)("option",{value:"create_new",className:"font-semibold text-purple-600",children:"✨ Create New Form with AI"}),(0,l.jsx)("optgroup",{label:"Existing Forms",children:m.map(e=>(0,l.jsx)("option",{value:e.id,children:e.title},e.id))})]}),e.form_id&&(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)("button",{onClick:()=>{let s=m.find(s=>s.id===e.form_id);((null==s?void 0:s.urlId)||(null==s?void 0:s.url_id))&&window.open("/forms/".concat(s.urlId||s.url_id),"_blank")},className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"View Form",children:(0,l.jsx)(b.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>P.push("/edit/".concat(e.form_id)),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"Edit Form",children:(0,l.jsx)(f.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>P.push("/responses/".concat(e.form_id)),className:"p-1 hover:bg-gray-200 rounded transition-colors",title:"View Responses",children:(0,l.jsx)(j.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:async()=>{confirm("Are you sure you want to remove this form from the applet?")&&ec(e.id,{form_id:null,config:{...e.config,form_id:null}})},className:"p-1 hover:bg-red-100 text-red-600 rounded transition-colors",title:"Remove Form",children:(0,l.jsx)(v.Z,{className:"w-4 h-4"})})]})]})}),"upload"===e.type&&(0,l.jsx)("div",{className:"mt-2 space-y-1",children:e.upload_url&&(0,l.jsxs)("div",{className:"text-sm",children:[(0,l.jsx)(u.Z,{className:"w-4 h-4 inline mr-1"}),(0,l.jsx)("a",{href:e.upload_url,target:"_blank",className:"underline",children:"View Upload"})]})}),(0,l.jsxs)("div",{className:"mt-3 p-2 border border-purple-500 bg-purple-50 rounded",children:[(0,l.jsx)("div",{className:"text-xs font-bold text-purple-700",children:"DEBUG INFO:"}),(0,l.jsxs)("div",{className:"text-xs",children:['Name: "',e.name,'"']}),(0,l.jsxs)("div",{className:"text-xs",children:['Type: "',e.type||"NULL",'"']}),(0,l.jsxs)("div",{className:"text-xs",children:["Is Link Submission? ","Link Submission"===e.name?"YES":"NO"]})]}),"link_submission"===e.type||"Link Submission"===e.name||(null===(a=e.description)||void 0===a?void 0:a.includes("Share deliverables and resources"))?(0,l.jsxs)("div",{className:"mt-3 p-3 border-2 border-blue-500 bg-blue-50 rounded-lg",children:[(0,l.jsx)("div",{className:"text-xs font-bold text-blue-700 mb-2",children:"Link Submission Configuration:"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"Heading"}),(0,l.jsx)("input",{type:"text",value:(null===(r=e.config)||void 0===r?void 0:r.heading)||"Project Deliverables",onChange:s=>ec(e.id,{config:{...e.config||{},heading:s.target.value}}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm font-medium bg-white",placeholder:"Enter heading (e.g., Project Deliverables)"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"text-xs font-medium text-gray-700 block mb-1",children:"Description"}),(0,l.jsx)("textarea",{value:(null===(i=e.config)||void 0===i?void 0:i.description)||"Please review the following materials:",onChange:s=>ec(e.id,{config:{...e.config||{},description:s.target.value}}),className:"w-full px-2 py-1 border border-gray-300 rounded text-sm bg-white",rows:"2",placeholder:"Add description or instructions..."})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("span",{className:"text-xs font-medium text-gray-700",children:"Links"}),(0,l.jsx)("button",{onClick:()=>{var s;let t=[...(null===(s=e.config)||void 0===s?void 0:s.links)||[],{text:"View Link",url:"https://example.com",description:""}];ec(e.id,{config:{...e.config||{},links:t}})},className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:"+ Add Link"})]}),0===((null===(o=e.config)||void 0===o?void 0:o.links)||[]).length?(0,l.jsx)("div",{className:"text-xs text-gray-500 italic p-2 bg-gray-50 rounded",children:'No links added yet. Click "Add Link" to get started.'}):(0,l.jsx)("div",{className:"space-y-2",children:((null===(c=e.config)||void 0===c?void 0:c.links)||[]).map((s,t)=>(0,l.jsxs)("div",{className:"p-2 bg-gray-50 rounded border border-gray-200",children:[(0,l.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,l.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,l.jsx)("input",{type:"text",value:s.text||"",onChange:s=>{var l;let a=[...(null===(l=e.config)||void 0===l?void 0:l.links)||[]];a[t]={...a[t],text:s.target.value},ec(e.id,{config:{...e.config||{},links:a}})},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Link text (e.g., View Mockups)"}),(0,l.jsx)("input",{type:"url",value:s.url||"",onChange:s=>{var l;let a=[...(null===(l=e.config)||void 0===l?void 0:l.links)||[]];a[t]={...a[t],url:s.target.value},ec(e.id,{config:{...e.config||{},links:a}})},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"https://..."}),(0,l.jsx)("input",{type:"text",value:s.description||"",onChange:s=>{var l;let a=[...(null===(l=e.config)||void 0===l?void 0:l.links)||[]];a[t]={...a[t],description:s.target.value},ec(e.id,{config:{...e.config||{},links:a}})},className:"w-full px-2 py-1 border rounded text-sm",placeholder:"Optional description"})]}),(0,l.jsx)("button",{onClick:()=>{var s;let l=((null===(s=e.config)||void 0===s?void 0:s.links)||[]).filter((e,s)=>s!==t);ec(e.id,{config:{...e.config||{},links:l}})},className:"p-1 text-red-600 hover:text-red-700 hover:bg-red-50 rounded",title:"Remove link",children:(0,l.jsx)(v.Z,{className:"w-4 h-4"})})]}),s.url&&(0,l.jsxs)("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center mt-1 text-xs text-blue-600 hover:text-blue-700",children:[(0,l.jsx)(b.Z,{className:"w-3 h-3 mr-1"}),"Test link"]})]},t))})]}),(0,l.jsxs)("div",{className:"flex items-center p-2 bg-gray-50 rounded",children:[(0,l.jsx)("input",{type:"checkbox",id:"ack-".concat(e.id),checked:(null===(p=e.config)||void 0===p?void 0:p.allow_client_acknowledgment)||!1,onChange:s=>ec(e.id,{config:{...e.config||{},allow_client_acknowledgment:s.target.checked}}),className:"mr-2"}),(0,l.jsx)("label",{htmlFor:"ack-".concat(e.id),className:"text-xs",children:"Allow client to mark as reviewed"})]})]})]}):null,_&&(0,l.jsxs)("div",{className:"mt-4 p-3 bg-white/50 rounded space-y-2",children:[e.user_progress_summary&&(null===(t=e.user_progress_summary.completed_users)||void 0===t?void 0:t.length)>0&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs font-bold",children:"Completed by:"}),(0,l.jsx)("div",{className:"mt-1 space-y-1",children:e.user_progress_summary.completed_users.map((e,s)=>(0,l.jsxs)("div",{className:"text-xs flex items-center",children:[(0,l.jsx)(d.Z,{className:"w-3 h-3 text-green-600 mr-1"}),(0,l.jsx)("span",{className:"text-gray-600",children:e.user_id.startsWith("client_")?"Client ".concat(e.user_id.substring(7,13),"..."):e.user_id}),e.completed_at&&(0,l.jsx)("span",{className:"text-gray-400 ml-2",children:new Date(e.completed_at).toLocaleDateString()})]},s))})]}),e.client_instructions&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs font-bold",children:"Client Instructions:"}),(0,l.jsx)("p",{className:"text-sm",children:e.client_instructions})]}),e.internal_notes&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs font-bold",children:"Internal Notes:"}),(0,l.jsx)("p",{className:"text-sm",children:e.internal_notes})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4 text-xs",children:[(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.requires_approval,onChange:s=>ec(e.id,{requires_approval:s.target.checked}),className:"mr-1"}),"Requires Approval"]}),(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:e.client_can_skip,onChange:s=>ec(e.id,{client_can_skip:s.target.checked}),className:"mr-1"}),"Client Can Skip"]})]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("button",{onClick:()=>V(_?null:e.id),className:"p-1 hover:bg-white/50 rounded",children:_?(0,l.jsx)(y.Z,{className:"w-4 h-4"}):(0,l.jsx)(N.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>B(C?null:e.id),className:"p-1 hover:bg-white/50 rounded",children:C?(0,l.jsx)(v.Z,{className:"w-4 h-4"}):(0,l.jsx)(w.Z,{className:"w-4 h-4"})}),(0,l.jsx)("button",{onClick:()=>em(e.id),className:"p-1 hover:bg-red-100 rounded text-red-600",children:(0,l.jsx)(k.Z,{className:"w-4 h-4"})})]})]})},e.id)})}),D&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,l.jsx)("div",{className:"p-6 border-b",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h3",{className:"text-xl font-bold",children:"Choose an Applet"}),(0,l.jsx)("button",{onClick:()=>{O(!1),R(null)},className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,l.jsx)(v.Z,{className:"w-5 h-5"})})]})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:I.map(e=>{var s;let t=F[e.type]||n.Z,a=S[e.type];return null==M||M.id,e.id,(0,l.jsxs)("button",{onClick:()=>{er(e)},className:"p-4 border-2 rounded-lg text-left transition-all hover:border-black hover:shadow-lg border-gray-200",children:[(0,l.jsx)("div",{className:"inline-flex p-2 rounded-lg mb-2 ".concat(a),children:(0,l.jsx)(t,{className:"w-5 h-5"})}),(0,l.jsx)("h4",{className:"font-bold",children:e.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,l.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:null===(s=e.tags)||void 0===s?void 0:s.map((e,s)=>(0,l.jsx)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:e},s))})]},e.id)})}),(0,l.jsx)("p",{className:"text-sm text-gray-500 text-center mt-4",children:"Click any applet to add it to your projectlet"})]})]})}),J&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)("div",{className:"p-6 border-b",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h3",{className:"text-xl font-bold",children:"Configure Form Applet"}),(0,l.jsx)("button",{onClick:()=>{G(!1),W("select"),K(null)},className:"p-2 hover:bg-gray-100 rounded-lg",children:(0,l.jsx)(v.Z,{className:"w-5 h-5"})})]})}),(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"Choose how you want to add a form to this projectlet"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("button",{onClick:()=>W("create"),className:"p-4 border-2 rounded-lg transition-all ".concat("create"===H?"border-black bg-black text-white":"border-gray-300 hover:border-gray-400"),children:[(0,l.jsx)(n.Z,{className:"w-8 h-8 mx-auto mb-2"}),(0,l.jsx)("div",{className:"font-semibold",children:"Create New Form"}),(0,l.jsx)("div",{className:"text-sm mt-1 opacity-80",children:"Use AI to generate a form with project context"})]}),(0,l.jsxs)("button",{onClick:()=>W("select"),className:"p-4 border-2 rounded-lg transition-all ".concat("select"===H?"border-black bg-black text-white":"border-gray-300 hover:border-gray-400"),children:[(0,l.jsx)(u.Z,{className:"w-8 h-8 mx-auto mb-2"}),(0,l.jsx)("div",{className:"font-semibold",children:"Use Existing Form"}),(0,l.jsx)("div",{className:"text-sm mt-1 opacity-80",children:"Select from previously created forms"})]})]})]}),"create"===H&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,l.jsx)("h4",{className:"font-semibold text-blue-900 mb-2",children:"AI-Powered Form Builder"}),(0,l.jsx)("p",{className:"text-sm text-blue-700 mb-3",children:"The AI will have access to:"}),(0,l.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1 ml-4",children:[(0,l.jsx)("li",{children:"• Project details and requirements"}),(0,l.jsx)("li",{children:"• Client information"}),(0,l.jsxs)("li",{children:["• Projectlet context: ",c]}),(0,l.jsx)("li",{children:"• Previously uploaded knowledge base"})]})]}),(0,l.jsx)("button",{onClick:ei,disabled:Q,className:"w-full bg-black text-white px-6 py-3 rounded-lg hover:bg-gray-800 disabled:opacity-50 flex items-center justify-center",children:Q?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Opening Form Builder..."]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"Create Form with AI"]})})]}),"select"===H&&(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Select a Form"}),(0,l.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto border rounded-lg p-2",children:0===m.length?(0,l.jsx)("p",{className:"text-center py-4 text-gray-500",children:"No forms available. Create one first."}):m.map(e=>(0,l.jsx)("div",{className:"w-full p-3 rounded-lg border transition-all ".concat(Y===e.id?"border-black bg-gray-50":"border-gray-200 hover:border-gray-400"),children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("button",{onClick:()=>K(e.id),className:"flex-1 text-left",children:[(0,l.jsx)("div",{className:"font-medium",children:e.title}),(0,l.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:[e.response_count||0," responses • Status: ",e.status||"active"]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2 ml-2",children:[(0,l.jsx)("button",{onClick:()=>window.open("/forms/".concat(e.url_id),"_blank"),className:"p-1.5 hover:bg-gray-200 rounded transition-colors",title:"View Form",children:(0,l.jsx)(o.Z,{className:"w-4 h-4 text-gray-600"})}),(0,l.jsx)("button",{onClick:()=>window.open("/edit/".concat(e.id),"_blank"),className:"p-1.5 hover:bg-gray-200 rounded transition-colors",title:"Edit Form",children:(0,l.jsx)(w.Z,{className:"w-4 h-4 text-gray-600"})}),(0,l.jsx)("button",{onClick:async()=>{if(confirm('Are you sure you want to delete "'.concat(e.title,'"?')))try{let s=await fetch("/api/aloa-forms/".concat(e.id),{method:"DELETE"});if(s.ok)await s.json(),C.ZP.success("Form deleted successfully"),setTimeout(()=>{window.location.reload()},500);else try{let e=await s.json();C.ZP.error(e.error||"Failed to delete form")}catch(e){C.ZP.error("Failed to delete form")}}catch(e){console.error("Error deleting form:",e),C.ZP.error("Failed to delete form")}},className:"p-1.5 hover:bg-red-100 rounded transition-colors",title:"Delete Form",children:(0,l.jsx)(k.Z,{className:"w-4 h-4 text-red-600"})})]})]})},e.id))})]}),(0,l.jsxs)("button",{onClick:eo,disabled:!Y,className:"w-full px-6 py-3 rounded-lg flex items-center justify-center ".concat(Y?"bg-black text-white hover:bg-gray-800":"bg-gray-200 text-gray-400 cursor-not-allowed"),children:[(0,l.jsx)(u.Z,{className:"w-5 h-5 mr-2"}),"Attach Selected Form"]})]})]})]})}),$&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,l.jsx)("div",{className:"p-6 border-b",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h3",{className:"text-xl font-display font-bold text-aloa-black uppercase tracking-tight flex items-center gap-2",children:[(0,l.jsx)(_.Z,{className:"w-6 h-6 text-purple-600"}),"AI Form Builder"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Creating form for: ",c]})]}),(0,l.jsx)("button",{onClick:()=>{ee(!1),R(null)},className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,l.jsx)(v.Z,{className:"w-5 h-5"})})]})}),(0,l.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[es&&es.stats&&es.stats.totalDocuments>0&&(0,l.jsx)("div",{className:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)(_.Z,{className:"w-5 h-5 text-purple-600 mr-2 flex-shrink-0 mt-0.5"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-purple-900",children:"AI Context Loaded"}),(0,l.jsxs)("p",{className:"text-xs text-purple-700 mt-1",children:["Using ",es.stats.totalDocuments," knowledge documents and ",es.stats.totalInsights," insights from this project"]})]})]})}),(0,l.jsx)(Z,{onMarkdownGenerated:en,projectContext:null==es?void 0:null===(s=es.project)||void 0===s?void 0:s.ai_context,projectName:c})]})]})})]})}},2222:function(e,s,t){t.d(s,{Z:function(){return l}});let l=(0,t(9205).Z)("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]])},8335:function(e,s,t){t.d(s,{Z:function(){return l}});let l=(0,t(9205).Z)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]])}}]);